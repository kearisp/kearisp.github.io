{"version":3,"file":"static/js/554.53619fe8.chunk.js","mappings":"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","sources":["../packages/motor-js/lib/core/Context.js","../packages/motor-js/lib/core/Vector.js","../packages/motor-js/lib/core/Polygon2D.js","../packages/motor-js/lib/core/Polygon.js","../packages/motor-js/lib/core/BSPNode.js","../packages/motor-js/lib/context/CanvasContext.js","../packages/motor-js/lib/context/SVGContext.js","../packages/motor-js/lib/events/Observable.js","../packages/motor-js/lib/core/Camera.js","../packages/motor-js/lib/utils/calcCameraRotationMatrix.js","../packages/motor-js/lib/core/Model.js","../packages/motor-js/lib/utils/calcDirectionMatrix.js","../packages/motor-js/lib/core/Color.js","../packages/motor-js/lib/context/WebGLContext.js","../packages/motor-js/lib/core/DataProvider.js","../packages/motor-js/lib/core/Scene.js","../packages/motor-js/lib/shapes/Sphere.js","../packages/motor-js/lib/events/Dispatchable.js","../packages/motor-js/lib/shapes/Cube.js","hooks/useControl.ts","views/controls/ButtonGroupControl/index.tsx","views/controls/SliderControl/index.tsx","views/controls/SwitchControl/index.tsx","views/pages/PathBuilderPage/blocks/ConfigForm/index.tsx","views/pages/PathBuilderPage/blocks/ConfigProvider/index.tsx","views/pages/PathBuilderPage/models/Lines.ts","views/pages/PathBuilderPage/blocks/PathBuilder/index.tsx","views/pages/PathBuilderPage/index.tsx"],"sourcesContent":["var Context = /** @class */ (function () {\n    function Context() {\n        this.width = 0;\n        this.height = 0;\n        this.fov = 45;\n        this.models = [];\n        this.debug = false;\n    }\n    Context.prototype.setDebug = function (debug) {\n        this.debug = debug;\n    };\n    Context.prototype.getWidth = function () {\n        return this.width;\n    };\n    Context.prototype.getHeight = function () {\n        return this.height;\n    };\n    Context.prototype.setSizes = function (width, height) {\n        this.setWidth(width);\n        this.setHeight(height);\n    };\n    Context.prototype.setWidth = function (width) {\n        this.width = width;\n    };\n    Context.prototype.setHeight = function (height) {\n        this.height = height;\n    };\n    Context.prototype.getFov = function () {\n        return this.fov;\n    };\n    Context.prototype.setFov = function (fov) {\n        this.fov = fov;\n    };\n    Context.prototype.addModel = function (model) {\n        this.models.push(model);\n    };\n    Context.prototype.removeModel = function (model) {\n        this.models = this.models.filter(function (m) { return m !== model; });\n    };\n    return Context;\n}());\nexport { Context };\n","var Vector = /** @class */ (function () {\n    function Vector(x, y, z) {\n        this.x = x;\n        this.y = y;\n        this.z = z;\n    }\n    Object.defineProperty(Vector.prototype, \"distance\", {\n        get: function () {\n            return Vector.distance(this);\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Vector.prototype.set = function (point) {\n        this.x = point.x;\n        this.y = point.y;\n        this.z = point.z;\n        return this;\n    };\n    Vector.prototype.add = function (point) {\n        this.set(Vector.summary(this, point));\n        return this;\n    };\n    Vector.prototype.multiply = function (by) {\n        this.set(Vector.multiply(this, by));\n        return this;\n    };\n    Vector.prototype.sub = function (point) {\n        this.set(Vector.subtract(this, point));\n        return this;\n    };\n    Vector.prototype.normalize = function () {\n        var _a = Vector.normalize(this), x = _a.x, y = _a.y, z = _a.z;\n        this.x = x;\n        this.y = y;\n        this.z = z;\n        return this;\n    };\n    Vector.prototype.toPoint = function () {\n        return {\n            x: this.x,\n            y: this.y,\n            z: this.z\n        };\n    };\n    Vector.fromPoint = function (point) {\n        return new Vector(point.x, point.y, point.z);\n    };\n    Vector.summary = function (a, b) {\n        return {\n            x: a.x + b.x,\n            y: a.y + b.y,\n            z: a.z + b.z\n        };\n    };\n    Vector.subtract = function (a, b) {\n        return {\n            x: a.x - b.x,\n            y: a.y - b.y,\n            z: a.z - b.z\n        };\n    };\n    Vector.cross = function (a, b) {\n        return {\n            x: a.y * b.z - a.z * b.y,\n            y: a.z * b.x - a.x * b.z,\n            z: a.x * b.y - a.y * b.x\n        };\n    };\n    Vector.distance = function (a) {\n        return Math.sqrt(Math.pow(a.x, 2) + Math.pow(a.y, 2) + Math.pow(a.z, 2));\n    };\n    Vector.distanceBetween = function (a, b) {\n        var v = Vector.subtract(b, a);\n        return Vector.distance(v);\n    };\n    Vector.normalize = function (a) {\n        var length = Math.sqrt(Math.pow(a.x, 2) + Math.pow(a.y, 2) + Math.pow(a.z, 2));\n        return {\n            x: a.x / length,\n            y: a.y / length,\n            z: a.z / length\n        };\n    };\n    Vector.magnitude = function (a) {\n        return Math.sqrt(Vector.dot(a, a));\n    };\n    Vector.angle = function (v1, v2) {\n        var mag1 = Vector.magnitude(v1), mag2 = Vector.magnitude(v2), dot = Vector.dot(v1, v2);\n        return Math.acos(dot / (mag1 * mag2));\n    };\n    Vector.multiply = function (a, by) {\n        return {\n            x: a.x * by,\n            y: a.y * by,\n            z: a.z * by\n        };\n    };\n    Vector.dot = function (a, b) {\n        return a.x * b.x + a.y * b.y + a.z * b.z;\n    };\n    Vector.intersectPlane = function (point, direction, v0, v1, v2) {\n        return Vector.intersectPlaneV2(point, direction, v0, v1, v2);\n    };\n    Vector.intersectPlaneV1 = function (point, direction, v0, v1, v2) {\n        var EPSILON = 0.0000001;\n        var edge1 = Vector.subtract(v1, v0);\n        var edge2 = Vector.subtract(v2, v0);\n        var planeNormal = Vector.cross(edge1, edge2);\n        var denominator = Vector.dot(planeNormal, direction);\n        if (Math.abs(denominator) < EPSILON) {\n            return null;\n        }\n        var t = Vector.dot(planeNormal, Vector.subtract(v0, point)) / denominator;\n        if (t < 0) {\n            return null;\n        }\n        return Vector.summary(point, Vector.multiply(direction, t));\n    };\n    Vector.intersectPlaneV2 = function (point, direction, v0, v1, v2) {\n        var edge1 = Vector.subtract(v1, v0);\n        var edge2 = Vector.subtract(v2, v0);\n        var normal = Vector.cross(edge1, edge2);\n        // Розрахунок відстані до площини\n        var d = -Vector.dot(normal, v0);\n        var denom = Vector.dot(normal, direction);\n        // Перевірка, чи вектор паралельний площині\n        if (Math.abs(denom) < 1e-6) {\n            return null;\n        }\n        var t = -(Vector.dot(normal, point) + d) / denom;\n        return Vector.summary(point, Vector.multiply(direction, t));\n    };\n    Vector.intersectPolygon = function (point, direction, polygon) {\n        var d = -(Vector.dot(polygon.getNormal(), polygon.points[0]));\n        var t = -(Vector.dot(polygon.getNormal(), point) + d) / Vector.dot(polygon.getNormal(), direction);\n        if (isNaN(t) || !isFinite(t)) {\n            return null;\n        }\n        var intersectPoint = Vector.summary(Vector.multiply(direction, t), point);\n        if (isNaN(intersectPoint.x) || !isFinite(intersectPoint.x)) {\n            console.log(point, t, intersectPoint);\n            debugger;\n        }\n        for (var i = 0; i < polygon.points.length; i++) {\n            var p1 = polygon.points[i];\n            var p2 = polygon.points[(i + 1) % polygon.points.length];\n            var side1 = Vector.subtract(p2, p1);\n            var side2 = Vector.subtract(intersectPoint, p1);\n            var crossProduct = Vector.cross(side1, side2);\n            if (Vector.dot(polygon.getNormal(), crossProduct) <= 1) {\n                return null;\n            }\n        }\n        return intersectPoint;\n    };\n    Vector.getAngle = function (p1, p2) {\n        var dot = Vector.dot(p1, p2);\n        var d1 = Vector.distance(p1);\n        var d2 = Vector.distance(p2);\n        var cosAngle = dot / (d1 * d2);\n        return Math.acos(cosAngle) * (180 / Math.PI);\n    };\n    Vector.areCoDirected = function (p1, p2) {\n        return Vector.areCoDirectedV2(p1, p2);\n    };\n    Vector.areCoDirectedV1 = function (pt1, pt2) {\n        // calculate ratios for each pair of coordinates\n        var ratioX = pt1.x / pt2.x;\n        var ratioY = pt1.y / pt2.y;\n        var ratioZ = pt1.z / pt2.z;\n        if (isNaN(ratioX) || isNaN(ratioY) || isNaN(ratioZ)) {\n            return false;\n        }\n        // check if each ratio is approximately equal to the other ratios (with epsilon precision)\n        var epsilon = Math.pow(10, -14);\n        if (Math.abs(ratioX - ratioY) > epsilon ||\n            Math.abs(ratioX - ratioZ) > epsilon ||\n            Math.abs(ratioY - ratioZ) > epsilon) {\n            return false;\n        }\n        // vectors are co-directed\n        return true;\n    };\n    Vector.areCoDirectedV2 = function (p1, p2) {\n        var dot = Vector.dot(p1, p2);\n        var d1 = Vector.distance(p1);\n        var d2 = Vector.distance(p2);\n        var cosAngle = dot / (d1 * d2);\n        return cosAngle <= Math.cos(Math.PI / 180 * 90);\n    };\n    return Vector;\n}());\nexport { Vector };\n","var Polygon2D = /** @class */ (function () {\n    function Polygon2D(points) {\n        this.points = points;\n    }\n    Polygon2D.prototype.getCenter = function () {\n        if (!this.center) {\n            this.calcCenter();\n        }\n        return this.center;\n    };\n    Polygon2D.prototype.calcCenter = function () {\n        var center = {\n            x: 0,\n            y: 0\n        };\n        for (var i = 0; i < this.points.length; i++) {\n            center.x += this.points[i].x;\n            center.y += this.points[i].y;\n        }\n        this.center = {\n            x: center.x / this.points.length,\n            y: center.y / this.points.length\n        };\n    };\n    return Polygon2D;\n}());\nexport { Polygon2D };\n","var __spreadArray = (this && this.__spreadArray) || function (to, from, pack) {\n    if (pack || arguments.length === 2) for (var i = 0, l = from.length, ar; i < l; i++) {\n        if (ar || !(i in from)) {\n            if (!ar) ar = Array.prototype.slice.call(from, 0, i);\n            ar[i] = from[i];\n        }\n    }\n    return to.concat(ar || Array.prototype.slice.call(from));\n};\nimport { Vector } from \"./Vector\";\nimport { Polygon2D } from \"./Polygon2D\";\nvar Polygon = /** @class */ (function () {\n    function Polygon(points, normal) {\n        this.points = points;\n        this.normal = !normal ? this.calcNormal() : normal;\n        this.center = this.calcCenter();\n    }\n    Polygon.prototype.setId = function (id) {\n        this.id = id;\n    };\n    Polygon.prototype.intersects = function (polygon) {\n        var axes = __spreadArray(__spreadArray([], Polygon.getNormals(this.points), true), Polygon.getNormals(polygon.points), true);\n        for (var _i = 0, axes_1 = axes; _i < axes_1.length; _i++) {\n            var axis = axes_1[_i];\n            var projection1 = Polygon.projection(this.points, axis);\n            var projection2 = Polygon.projection(polygon.points, axis);\n            if (projection1.max < projection2.min || projection2.max < projection1.min) {\n                return false;\n            }\n            if (projection1.max === projection2.min || projection2.max === projection1.min) {\n                return false;\n            }\n        }\n        return true;\n    };\n    Polygon.prototype.smooth = function () {\n        return [];\n    };\n    Polygon.prototype.getNormal = function () {\n        return this.normal;\n    };\n    Polygon.prototype.calcNormal = function () {\n        var normal = {\n            x: 0,\n            y: 0,\n            z: 0\n        };\n        for (var i = 0; i < this.points.length; i++) {\n            var p1 = this.points[i];\n            var p2 = this.points[(i + 1) % this.points.length];\n            var p3 = this.points[(i + 2) % this.points.length];\n            var vector1 = Vector.subtract(p1, p2);\n            var vector2 = Vector.subtract(p1, p3);\n            var cross = Vector.cross(vector1, vector2);\n            normal = Vector.summary(normal, cross);\n        }\n        return Vector.normalize({\n            x: normal.x / this.points.length,\n            y: normal.y / this.points.length,\n            z: normal.z / this.points.length\n        });\n    };\n    Polygon.prototype.getCenter = function () {\n        return this.center;\n    };\n    Polygon.prototype.calcCenter = function () {\n        var center = {\n            x: 0,\n            y: 0,\n            z: 0\n        };\n        for (var i = 0; i < this.points.length; i++) {\n            center = Vector.summary(this.points[i], center);\n        }\n        return {\n            x: center.x / this.points.length,\n            y: center.y / this.points.length,\n            z: center.z / this.points.length,\n        };\n    };\n    Polygon.prototype.getVector1 = function () {\n        // return Vector.normalize(Vector.subtract(this.points[0], this.points[1]));\n        return Vector.normalize(Vector.cross(this.getNormal(), { x: 0, y: 0, z: -1 }));\n    };\n    Polygon.prototype.getVector2 = function () {\n        // return Vector.normalize(Vector.cross(this.getVector1(), this.getNormal()));\n        return Vector.normalize(Vector.cross(this.getNormal(), { x: 1, y: 0, z: 0 }));\n    };\n    Polygon.prototype.isOnSamePlane = function (p) {\n        var point = this.points[0];\n        if (!point) {\n            return false;\n        }\n        var normal = this.getNormal();\n        var dot = Vector.dot(Vector.subtract(p, point), normal);\n        return Math.abs(dot) < 0.0001;\n    };\n    Polygon.prototype.isContainPoint = function (p) {\n        return this.isContainPointV2(p);\n    };\n    Polygon.prototype.isContainPointV1 = function (point) {\n        var inside = false;\n        for (var i = 0; i < this.points.length; i++) {\n            var p1 = this.points[i];\n            var p2 = this.points[(i + 1) % this.points.length];\n            var p3 = this.points[(i + 2) % this.points.length];\n            var v0 = Vector.subtract(p3, p1);\n            var v1 = Vector.subtract(p2, p1);\n            var v2 = Vector.subtract(point, p1);\n            var dot00 = Vector.dot(v0, v0);\n            var dot01 = Vector.dot(v0, v1);\n            var dot02 = Vector.dot(v0, v2);\n            var dot11 = Vector.dot(v1, v1);\n            var dot12 = Vector.dot(v1, v2);\n            var invDenom = 1 / (dot00 * dot11 - dot01 * dot01);\n            var u = (dot11 * dot02 - dot01 * dot12) * invDenom;\n            var v = (dot00 * dot12 - dot01 * dot02) * invDenom;\n            if ((u >= 0) && (v >= 0) && (u + v < 1)) {\n                inside = true;\n                break;\n            }\n        }\n        return inside;\n    };\n    Polygon.prototype.isContainPointV2 = function (point) {\n        var sum = 0;\n        for (var i = 0; i < this.points.length; i++) {\n            var a1 = this.points[i];\n            var a2 = this.points[(i + 1) % this.points.length];\n            var vector = Vector.subtract(a2, a1);\n            var t = Vector.dot(vector, Vector.subtract(point, a1)) / Vector.dot(vector, vector);\n            var epsilon = 0.000001;\n            if (t > epsilon && t < (1 - epsilon)) {\n                sum += Vector.angle(Vector.subtract(a2, point), Vector.subtract(a1, point));\n            }\n        }\n        return Math.abs(sum - Math.PI * 2) <= 0.01;\n    };\n    Polygon.prototype.isContainPointV3 = function (point) {\n        for (var i = 0; i < this.points.length; i++) {\n            var p1 = this.points[i];\n            var p2 = this.points[(i + 1) % this.points.length];\n            var side1 = Vector.subtract(p2, p1);\n            var side2 = Vector.subtract(point, p1);\n            var crossProduct = Vector.cross(side1, side2);\n            if (Vector.dot(this.getNormal(), crossProduct) <= -1) {\n                return false;\n            }\n        }\n        return true;\n    };\n    Polygon.prototype.project = function (camera) {\n        var points = this.points.map(function (point) {\n            if (!camera) {\n                return {\n                    x: point.x,\n                    y: point.y\n                };\n            }\n            return camera.projectPoint(point);\n        }).filter(function (point) {\n            return !isNaN(point.x) && !isNaN(point.y);\n        });\n        return new Polygon2D(points);\n    };\n    Polygon.prototype.project2 = function () {\n        var _this = this;\n        function dotProduct(n, p) {\n            return n.x * p.x + n.y * p.y + n.z * p.z;\n        }\n        function scaleVector(n, scalar) {\n            return {\n                x: n.x * scalar,\n                y: n.y * scalar,\n                z: n.z * scalar\n            };\n        }\n        function pointDifference(a, b) {\n            return {\n                x: a.x - b.x,\n                y: a.y - b.y,\n                z: a.z - b.z\n            };\n        }\n        function projectPointOnPlane(p, n) {\n            var scaledN = scaleVector(n, dotProduct(n, p));\n            return pointDifference(p, scaledN);\n        }\n        var projectedPoints = this.points.map(function (point) {\n            return projectPointOnPlane(point, Vector.subtract(_this.points[0], _this.points[1]));\n        });\n        return new Polygon2D(projectedPoints);\n    };\n    Polygon.isIntersect = function (A, B) {\n        return false;\n    };\n    Polygon.intersect = function (A, B) {\n        var before = [];\n        var after = [];\n        var isBefore = true;\n        for (var i = 0; i < A.points.length; i++) {\n            var a1 = A.points[i];\n            var a2 = A.points[(i + 1) % A.points.length];\n            var vector = Vector.subtract(a2, a1);\n            if (isBefore) {\n                before.push(a1);\n            }\n            else {\n                after.push(a1);\n            }\n            for (var j = 0; j < B.points.length; j++) {\n                var b1 = B.points[j];\n                var b2 = B.points[(j + 1) % B.points.length];\n                var b3 = B.points[(j + 2) % B.points.length];\n                var intersectPoint = Vector.intersectPlane(a1, vector, b1, b2, b3);\n                if (intersectPoint && Vector.distance(Vector.subtract(a1, intersectPoint)) < 0) {\n                    continue;\n                }\n                if (intersectPoint && A.isContainPoint(intersectPoint)) {\n                    // if(debug) {\n                    //     console.log(\"intersectPoint:\", intersectPoint);\n                    // }\n                    before.push(intersectPoint);\n                    after.push(intersectPoint);\n                    isBefore = !isBefore;\n                    break;\n                }\n            }\n        }\n        if (after.length === 0) {\n            return [A];\n        }\n        var ABefore = new Polygon(before);\n        ABefore.setId(\"\".concat(A.id, \".before\"));\n        ABefore.color = A.color;\n        var AAfter = new Polygon(after);\n        AAfter.setId(\"\".concat(A.id, \".after\"));\n        AAfter.color = A.color;\n        return [ABefore, AAfter];\n    };\n    Polygon.getNormals = function (points) {\n        var normals = [];\n        for (var i = 0; i < points.length; i++) {\n            var p1 = points[i];\n            var p2 = points[(i + 1) % points.length];\n            var edge = {\n                x: p2.x - p1.x,\n                y: p2.y - p1.y,\n                z: p2.z - p1.z\n            };\n            var normal = {\n                x: -edge.y,\n                y: edge.x,\n                z: edge.z\n            };\n            normals.push(normal);\n        }\n        return normals;\n    };\n    Polygon.projection = function (points, axis) {\n        var min = axis.x * points[0].x + axis.y * points[0].y;\n        var max = min;\n        for (var i = 1; i < points.length; i++) {\n            var p = axis.x * points[i].x + axis.y * points[i].y;\n            if (p < min) {\n                min = p;\n            }\n            else if (p > max) {\n                max = p;\n            }\n        }\n        return { min: min, max: max };\n    };\n    Polygon.prototype.triangulate = function (debug) {\n        if (debug === void 0) { debug = false; }\n        return this.triangulateV1(debug);\n    };\n    Polygon.prototype.triangulateV1 = function (debug) {\n        if (debug === void 0) { debug = false; }\n        var polygons = [];\n        var points = this.points.slice();\n        while (points.length > 3) {\n            var hasCut = false;\n            for (var i = 0; i < points.length; i++) {\n                if (points.length === 3) {\n                    break;\n                }\n                var p1 = points[i];\n                var p2 = points[(i + 1) % points.length];\n                var p3 = points[(i + 2) % points.length];\n                var center = {\n                    x: (p1.x + p3.x) / 2,\n                    y: (p1.y + p3.y) / 2,\n                    z: (p1.z + p3.z) / 2\n                };\n                if (this.isContainPoint(center)) {\n                    var polygon_1 = new Polygon([p1, p2, p3]);\n                    polygon_1.color = this.color;\n                    polygons.push(polygon_1);\n                    points.splice((i + 1) % points.length, 1);\n                    hasCut = true;\n                }\n            }\n            if (!hasCut) {\n                break;\n            }\n        }\n        var polygon = new Polygon(points);\n        polygon.color = this.color;\n        polygons.push(polygon);\n        return polygons;\n    };\n    return Polygon;\n}());\nexport { Polygon };\n","var __spreadArray = (this && this.__spreadArray) || function (to, from, pack) {\n    if (pack || arguments.length === 2) for (var i = 0, l = from.length, ar; i < l; i++) {\n        if (ar || !(i in from)) {\n            if (!ar) ar = Array.prototype.slice.call(from, 0, i);\n            ar[i] = from[i];\n        }\n    }\n    return to.concat(ar || Array.prototype.slice.call(from));\n};\nimport { Polygon } from \"./Polygon\";\nimport { Vector } from \"./Vector\";\nvar BSPNode = /** @class */ (function () {\n    function BSPNode(polygons, camera, debug) {\n        if (debug === void 0) { debug = false; }\n        this.debug = false;\n        this.camera = camera;\n        var front = [];\n        var back = [];\n        var _a = polygons.sort(function (a, b) {\n            // return Vector.distance(b.getCenter()) - Vector.distance(a.getCenter());\n            return Vector.distance(a.getCenter()) - Vector.distance(b.getCenter());\n        }), root = _a[0], rest = _a.slice(1);\n        this.root = root;\n        this.debug = debug;\n        for (var _i = 0, rest_1 = rest; _i < rest_1.length; _i++) {\n            var polygon = rest_1[_i];\n            var intersects = Polygon.intersect(polygon, root);\n            for (var _b = 0, intersects_1 = intersects; _b < intersects_1.length; _b++) {\n                var intersect = intersects_1[_b];\n                var type = this.classifyPolygon(intersect);\n                switch (type) {\n                    case \"front\":\n                        front.push(intersect);\n                        break;\n                    case \"back\":\n                        back.push(intersect);\n                        break;\n                    case \"coplanar\":\n                        // TODO\n                        if (this.debug) {\n                            console.log(type, this.root, intersect);\n                        }\n                        break;\n                }\n            }\n        }\n        this.front = front.length > 0 ? new BSPNode(front, camera, this.debug) : null;\n        this.back = back.length > 0 ? new BSPNode(back, camera, this.debug) : null;\n    }\n    BSPNode.prototype.classifyPolygon = function (polygon) {\n        return this.isInFront(polygon) ? \"front\" : \"back\";\n    };\n    BSPNode.prototype.isInFront = function (polygon) {\n        return this.isInFrontV1(polygon);\n        // return this.isInFrontV2(polygon);\n    };\n    BSPNode.prototype.isInFrontV1 = function (polygon) {\n        var vector = Vector.subtract(this.root.getCenter(), polygon.getCenter());\n        return Vector.dot(this.root.getNormal(), vector) < 0;\n    };\n    BSPNode.prototype.isInFrontV2 = function (polygon) {\n        var direction = {\n            x: 0,\n            y: 0,\n            z: -1\n        };\n        var viewVector = Vector.subtract(this.root.getCenter(), direction);\n        var normal = this.root.getNormal();\n        var dotProduct = Vector.dot(normal, viewVector);\n        var magnitudeProduct = Vector.magnitude(normal) * Vector.magnitude(viewVector);\n        var cosTheta = dotProduct / magnitudeProduct;\n        return cosTheta > 0;\n    };\n    BSPNode.prototype.traverse = function (direction, render) {\n        if (!this.root) {\n            return;\n        }\n        this.traverseV1(direction, render);\n        // this.traverseV2(direction, render);\n    };\n    BSPNode.prototype.traverseV1 = function (direction, render) {\n        if (Vector.dot(this.root.getNormal(), direction) < 0) {\n            if (this.front) {\n                this.front.traverseV1(direction, render);\n            }\n            render(this.root);\n            if (this.back) {\n                this.back.traverseV1(direction, render);\n            }\n        }\n        else {\n            if (this.back) {\n                this.back.traverseV1(direction, render);\n            }\n            render(this.root);\n            if (this.front) {\n                this.front.traverseV1(direction, render);\n            }\n        }\n    };\n    BSPNode.prototype.traverseV2 = function (direction, render) {\n        var frontFirst = Vector.dot(this.root.getNormal(), direction) < 0;\n        var v1 = this.root.getVector1();\n        var v2 = this.root.getVector2();\n        var p1 = Vector.multiply(v1, 100), p2 = Vector.multiply(v1, -100), p3 = Vector.summary(this.root.getCenter(), Vector.multiply(v2, -100)), p4 = Vector.summary(this.root.getCenter(), Vector.multiply(v2, 100));\n        var d1 = this.camera.projectPoint(p1), d2 = this.camera.projectPoint(p2), d3 = this.camera.projectPoint(p3), d4 = this.camera.projectPoint(p4);\n        var log = [\n            // \"\\n\", \"p1=\", {x: p1.x, y: p1.y},\n            // \"\\n\", \"p2=\", {x: p2.x, y: p2.y},\n            \"\\n\", \"p3=\", { x: p3.x, y: p3.y },\n            \"\\n\", \"p4=\", { x: p4.x, y: p4.y },\n            // \"\\n\", \"d1=\", d1,\n            // \"\\n\", \"d2=\", d2,\n            \"\\n\", \"d3=\", d3,\n            \"\\n\", \"d4=\", d4\n        ];\n        if (Math.abs(p3.x - p4.x) < 0.3 && p3.y > p4.y && d3.y < d4.y) {\n            if (this.debug) {\n                console.log.apply(console, __spreadArray([this.root.id, \"y changed 1\"], log, false));\n            }\n            frontFirst = !frontFirst;\n        }\n        if (frontFirst) {\n            if (this.front) {\n                this.front.traverseV2(direction, render);\n            }\n            render(this.root);\n            if (this.back) {\n                this.back.traverseV2(direction, render);\n            }\n        }\n        else {\n            if (this.back) {\n                this.back.traverseV2(direction, render);\n            }\n            render(this.root);\n            if (this.front) {\n                this.front.traverseV2(direction, render);\n            }\n        }\n    };\n    return BSPNode;\n}());\nexport { BSPNode };\n","var __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        if (typeof b !== \"function\" && b !== null)\n            throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nimport { Context } from \"../core/Context\";\nimport { Polygon } from \"../core/Polygon\";\nimport { BSPNode } from \"../core/BSPNode\";\nvar CanvasContext = /** @class */ (function (_super) {\n    __extends(CanvasContext, _super);\n    function CanvasContext() {\n        var _this = _super.call(this) || this;\n        _this.canvas = document.createElement(\"canvas\");\n        // @ts-ignore\n        _this.context = _this.canvas.getContext(\"2d\");\n        return _this;\n    }\n    Object.defineProperty(CanvasContext.prototype, \"domElement\", {\n        get: function () {\n            return this.canvas;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    CanvasContext.prototype.setWidth = function (width) {\n        _super.prototype.setWidth.call(this, width);\n        this.canvas.width = width;\n    };\n    CanvasContext.prototype.setHeight = function (height) {\n        _super.prototype.setHeight.call(this, height);\n        this.canvas.height = height;\n    };\n    CanvasContext.prototype.projectPoint = function (point) {\n        return {\n            x: NaN,\n            y: NaN\n        };\n    };\n    CanvasContext.prototype.setStrokeStyle = function (color) {\n        this.context.strokeStyle = color;\n    };\n    CanvasContext.prototype.setFillStyle = function (color) {\n        this.context.fillStyle = color;\n    };\n    CanvasContext.prototype.drawLine = function (start, end) {\n        this.context.lineWidth = 0.5;\n        this.context.beginPath();\n        this.context.moveTo(this.getWidth() / 2 + start.x, this.getHeight() / 2 - start.y);\n        this.context.lineTo(this.getWidth() / 2 + end.x, this.getHeight() / 2 - end.y);\n        this.context.stroke();\n        this.context.closePath();\n    };\n    CanvasContext.prototype.drawPolygon = function (polygon) {\n        // TODO\n    };\n    CanvasContext.prototype.fillRect = function (x, y, w, h) {\n        this.context.fillRect(x, y, w, h);\n    };\n    CanvasContext.prototype.fillPolygon = function (points) {\n        this.context.beginPath();\n        var start = points[0], rest = points.slice(1);\n        if (!start) {\n            return;\n        }\n        this.context.moveTo((start.x + 1) * this.getWidth() / 2, (1 - start.y) * this.getHeight() / 2);\n        for (var i = 0; i < rest.length; i++) {\n            this.context.lineTo((rest[i].x + 1) * this.getWidth() / 2, (1 - rest[i].y) * this.getHeight() / 2);\n        }\n        this.context.closePath();\n        this.context.stroke();\n        this.context.fill();\n    };\n    CanvasContext.prototype.clear = function () {\n        this.context.clearRect(0, 0, this.getWidth(), this.getHeight());\n    };\n    CanvasContext.prototype.render = function (models, camera) { };\n    CanvasContext.prototype.renderPolygons = function (polygons, camera) {\n        var _this = this;\n        var bspNode = new BSPNode(polygons, camera, false);\n        var front = new Polygon([\n            { x: -100, y: -100, z: -1000 },\n            { x: 100, y: -100, z: -1000 },\n            { x: -100, y: -100, z: -1000 },\n            { x: 100, y: 100, z: -1000 }\n        ]);\n        bspNode.traverse({ x: 0, y: 0, z: 1 }, function (polygon) {\n            _this.setStrokeStyle(\"#445555\");\n            _this.setFillStyle(polygon.color || \"#990000\");\n            var polygons = Polygon.intersect(polygon, front);\n            polygons.forEach(function (polygon) {\n                _this.fillPolygon(polygon.project(camera).points);\n            });\n        });\n    };\n    return CanvasContext;\n}(Context));\nexport { CanvasContext };\n","var __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        if (typeof b !== \"function\" && b !== null)\n            throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nimport { Context } from \"../core/Context\";\nimport { BSPNode } from \"../core/BSPNode\";\nvar SVGContext = /** @class */ (function (_super) {\n    __extends(SVGContext, _super);\n    function SVGContext() {\n        var _this = _super.call(this) || this;\n        _this.strokeStyle = \"#FFFFFF\";\n        _this.fillStyle = \"#FFFFFF\";\n        _this.svg = document.createElementNS(\"http://www.w3.org/2000/svg\", \"svg\");\n        _this.svg.setAttribute(\"width\", \"100%\");\n        _this.svg.setAttribute(\"height\", \"100%\");\n        return _this;\n    }\n    Object.defineProperty(SVGContext.prototype, \"domElement\", {\n        get: function () {\n            return this.svg;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    SVGContext.prototype.createSVGElement = function (type) {\n        return document.createElementNS(\"http://www.w3.org/2000/svg\", type);\n    };\n    SVGContext.prototype.setStrokeStyle = function (color) {\n        this.strokeStyle = color;\n    };\n    SVGContext.prototype.setFillStyle = function (color) {\n        this.fillStyle = color;\n    };\n    SVGContext.prototype.drawLine = function (start, end) {\n        var line = document.createElementNS(\"http://www.w3.org/2000/svg\", \"line\");\n        line.setAttribute(\"x1\", \"\".concat(start.x));\n        line.setAttribute(\"y1\", \"\".concat(start.y));\n        line.setAttribute(\"x2\", \"\".concat(end.x));\n        line.setAttribute(\"y2\", \"\".concat(end.y));\n        line.setAttribute(\"stroke\", this.strokeStyle);\n        line.setAttribute(\"stroke-width\", \"1\");\n        this.svg.appendChild(line);\n    };\n    SVGContext.prototype.fillRect = function (x, y, w, h) {\n        var rect = document.createElementNS(\"http://www.w3.org/2000/svg\", \"rect\");\n        rect.setAttribute(\"x\", \"\".concat(x));\n        rect.setAttribute(\"y\", \"\".concat(y));\n        rect.setAttribute(\"width\", \"\".concat(w));\n        rect.setAttribute(\"height\", \"\".concat(h));\n        rect.setAttribute(\"fill\", this.fillStyle);\n        this.svg.appendChild(rect);\n    };\n    SVGContext.prototype.fillPolygon = function (points) {\n        var _this = this;\n        var polygon = document.createElementNS(\"http://www.w3.org/2000/svg\", \"polygon\");\n        polygon.setAttribute(\"style\", \"fill: \".concat(this.fillStyle));\n        polygon.setAttribute(\"points\", points.map(function (point) {\n            return \"\".concat((point.x + 1) * _this.width / 2, \",\").concat((1 - point.y) * _this.getHeight() / 2);\n        }).join(\" \"));\n        polygon.setAttribute(\"stroke-width\", \"0.9\");\n        polygon.setAttribute(\"stroke\", \"black\");\n        this.svg.append(polygon);\n    };\n    SVGContext.prototype.clear = function () {\n        while (this.svg.firstChild) {\n            this.svg.removeChild(this.svg.firstChild);\n        }\n    };\n    SVGContext.prototype.render = function (models, camera) {\n        //\n    };\n    SVGContext.prototype.renderPolygons = function (polygons, camera) {\n        var _this = this;\n        var bspNode = new BSPNode(polygons, camera, false);\n        bspNode.traverse({ x: 0, y: 0, z: 1 }, function (polygon) {\n            _this.setStrokeStyle(\"#445555\");\n            _this.setFillStyle(polygon.color || \"#990000\");\n            _this.fillPolygon(polygon.project(camera).points);\n        });\n    };\n    return SVGContext;\n}(Context));\nexport { SVGContext };\n","var Observable = /** @class */ (function () {\n    function Observable() {\n        this.listeners = {};\n    }\n    Observable.prototype.addEventListener = function (type, listener) {\n        if (!this.listeners[type]) {\n            this.listeners[type] = [];\n        }\n        this.listeners[type].push(listener);\n    };\n    Observable.prototype.removeEventListener = function (type, listener) {\n        if (this.listeners[type]) {\n            var index = this.listeners[type].indexOf(listener);\n            if (index !== -1) {\n                this.listeners[type].splice(index, 1);\n            }\n        }\n    };\n    Observable.prototype.emit = function (type, event) {\n        if (this.listeners[type]) {\n            this.listeners[type].forEach(function (listener) { return listener(event); });\n        }\n    };\n    return Observable;\n}());\nexport { Observable };\n","var __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        if (typeof b !== \"function\" && b !== null)\n            throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nimport { mat4 } from \"gl-matrix\";\nimport { Vector } from \"./Vector\";\nimport { Observable } from \"../events/Observable\";\nimport { calcCameraRotationMatrixV2 } from \"../utils/calcCameraRotationMatrix\";\nvar Camera = /** @class */ (function (_super) {\n    __extends(Camera, _super);\n    function Camera(context, position, direction) {\n        if (position === void 0) { position = { x: 0, y: 0, z: 0 }; }\n        if (direction === void 0) { direction = { x: 0, y: 0, z: 1 }; }\n        var _this = _super.call(this) || this;\n        _this.context = context;\n        _this.isDebug = false;\n        _this.fov = 45;\n        _this.pitch = 0;\n        _this.yaw = 0;\n        _this.roll = 0;\n        _this.position = Vector.fromPoint(position);\n        _this.direction = Vector.fromPoint(direction);\n        _this.rotationMatrix = _this.calcDirectionMatrix();\n        return _this;\n    }\n    Camera.prototype.getPosition = function () {\n        return this.position;\n    };\n    Camera.prototype.setPosition = function (position) {\n        this.position.set(position);\n        this.rotationMatrix = this.calcDirectionMatrix();\n        this.emit(\"positionChange\", {\n            position: this.position\n        });\n    };\n    Camera.prototype.calcDirectionMatrix = function () {\n        return calcCameraRotationMatrixV2(this.position, this.direction);\n    };\n    Camera.prototype.getProjectionMatrix = function () {\n        var fieldOfView = (this.fov * Math.PI) / 180; // in radians\n        var aspect = this.context.getWidth() / this.context.getHeight();\n        var zNear = 0.1;\n        var zFar = 1500.0;\n        var projectionMatrix = mat4.create();\n        // note: glmatrix.js always has the first argument\n        // as the destination to receive the result.\n        mat4.perspective(projectionMatrix, fieldOfView, aspect, zNear, zFar);\n        var matrix = [];\n        for (var i = 0; i < 4; i++) {\n            matrix[i] = [\n                projectionMatrix[i * 4],\n                projectionMatrix[i * 4 + 1],\n                projectionMatrix[i * 4 + 2],\n                projectionMatrix[i * 4 + 3]\n            ];\n        }\n        return matrix;\n    };\n    Camera.prototype.transformPointToCameraView = function (point) {\n        var matrix = this.rotationMatrix;\n        var x = point.x * matrix[0][0] + point.y * matrix[1][0] + point.z * matrix[2][0] + matrix[3][0];\n        var y = point.x * matrix[0][1] + point.y * matrix[1][1] + point.z * matrix[2][1] + matrix[3][1];\n        var z = point.x * matrix[0][2] + point.y * matrix[1][2] + point.z * matrix[2][2] + matrix[3][2];\n        // const w = point.x * matrix[0][3] + point.y * matrix[1][3] + point.z * matrix[2][3] + matrix[3][3];\n        var w = 1;\n        return {\n            x: x / w,\n            y: y / w,\n            z: z / w\n        };\n    };\n    Camera.prototype.projectPoint = function (point) {\n        var projected = this.projectPointV2(point);\n        if (Math.abs(projected.x) > 1 || Math.abs(projected.y) > 1 || Math.abs(projected.z) > 1) {\n            return {\n                x: NaN,\n                y: NaN,\n                z: NaN\n            };\n        }\n        return projected;\n    };\n    Camera.prototype.projectPointV1 = function (point) {\n        var x = point.x, y = point.y, z = point.z;\n        if (z / 3 <= -this.fov) {\n            return { x: NaN, y: NaN };\n        }\n        var scale = this.fov / (this.fov + z / 3);\n        // const scale = 1;\n        return {\n            x: scale * x,\n            y: scale * y\n        };\n    };\n    Camera.prototype.projectPointV2 = function (point) {\n        var matrix = this.getProjectionMatrix();\n        var x = point.x * matrix[0][0] + point.y * matrix[1][0] + point.z * matrix[2][0] + matrix[3][0];\n        var y = point.x * matrix[0][1] + point.y * matrix[1][1] + point.z * matrix[2][1] + matrix[3][1];\n        var z = point.x * matrix[0][2] + point.y * matrix[1][2] + point.z * matrix[2][2] + matrix[3][2];\n        var w = point.x * matrix[0][3] + point.y * matrix[1][3] + point.z * matrix[2][3] + matrix[3][3];\n        return {\n            x: x / w,\n            y: y / w,\n            z: z / w\n        };\n    };\n    Camera.prototype.getFov = function () {\n        return this.fov;\n    };\n    Camera.prototype.setFov = function (fov) {\n        this.fov = fov;\n        this.emit(\"fovChange\", {\n            fov: this.fov\n        });\n    };\n    Camera.prototype.setDebug = function (debug) {\n        this.isDebug = debug;\n    };\n    Camera.prototype.getDirection = function () {\n        return this.direction;\n    };\n    Camera.prototype.getDirectionLeft = function () {\n        return Vector.cross(this.direction, {\n            x: 0,\n            y: 1,\n            z: 0\n        });\n    };\n    Camera.prototype.setDirection = function (direction) {\n        this.direction.set(direction); //= Vector.normalize(direction);\n        this.rotationMatrix = this.calcDirectionMatrix();\n        this.emit(\"directionChange\", {\n            direction: this.direction,\n            pitch: this.pitch,\n            yaw: this.yaw\n        });\n    };\n    Camera.prototype.setDirectionFromAngles = function (pitch, yaw) {\n        this.pitch = Math.max(Math.min(pitch, 90), -90);\n        this.yaw = yaw;\n        var pitchRadians = this.pitch * (Math.PI / 180), yawRadians = this.yaw * (Math.PI / 180);\n        this.setDirection({\n            x: Math.cos(pitchRadians) * Math.sin(yawRadians),\n            y: Math.sin(pitchRadians),\n            z: Math.cos(pitchRadians) * Math.cos(yawRadians)\n        });\n    };\n    Camera.prototype.getPitch = function () {\n        // return Math.asin(this.direction.y) * (180 / Math.PI);\n        return this.pitch;\n    };\n    Camera.prototype.setPitch = function (pitch) {\n        this.setDirectionFromAngles(pitch, this.yaw);\n    };\n    Camera.prototype.getYaw = function () {\n        // return Math.atan2(this.direction.z, this.direction.x) * (180 / Math.PI);\n        return this.yaw;\n    };\n    Camera.prototype.setYaw = function (yaw) {\n        this.setDirectionFromAngles(this.pitch, yaw);\n    };\n    Camera.prototype.getRoll = function () {\n        return this.roll;\n    };\n    Camera.prototype.setRoll = function (roll) {\n        this.roll = roll;\n    };\n    return Camera;\n}(Observable));\nexport { Camera };\n","import { Vector } from \"../core/Vector\";\nexport var calcCameraRotationMatrixV1 = function (eye, center, up) {\n    var f = Vector.normalize(Vector.subtract(center, eye));\n    var s = Vector.normalize(Vector.cross(f, up));\n    var u = Vector.cross(s, f);\n    return [\n        [s.x, u.x, -f.x, 0],\n        [s.y, u.y, -f.y, 0],\n        [s.z, u.z, -f.z, 0],\n        [-Vector.dot(s, eye), -Vector.dot(u, eye), Vector.dot(f, eye), 1]\n    ];\n};\nexport var calcCameraRotationMatrixV2 = function (position, direction, up) {\n    if (up === void 0) { up = { x: 0, y: 1, z: 0 }; }\n    var right = Vector.normalize(Vector.cross(up, direction));\n    var newUp = Vector.normalize(Vector.cross(direction, right));\n    return [\n        [right.x, newUp.x, direction.x, position.x],\n        [right.y, newUp.y, direction.y, position.y],\n        [right.z, newUp.z, direction.z, position.z],\n        [0, 0, 0, 1]\n    ];\n};\n","var __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        if (typeof b !== \"function\" && b !== null)\n            throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nimport { Vector } from \"./Vector\";\nimport { Polygon } from \"./Polygon\";\nimport { Observable } from \"../events/Observable\";\nimport { calcDirectionMatrix } from \"../utils/calcDirectionMatrix\";\nvar Model = /** @class */ (function (_super) {\n    __extends(Model, _super);\n    function Model(position) {\n        var _this = _super.call(this) || this;\n        _this.scale = 1;\n        _this.rotation = 0;\n        _this.rotationDirection = { x: 0, y: 1, z: 0 };\n        _this.points = [];\n        _this.polygons = [];\n        _this.position = position || { x: 0, y: 0, z: 0 };\n        _this.rotationMatrix = _this.calcDirectionMatrix();\n        return _this;\n    }\n    Model.prototype.getId = function () {\n        return this.id;\n    };\n    Model.prototype.setId = function (id) {\n        this.id = id;\n    };\n    Model.prototype.getPosition = function () {\n        return this.position;\n    };\n    Model.prototype.setPosition = function (position) {\n        this.position = position;\n    };\n    Model.prototype.getPoints = function () {\n        var _this = this;\n        return this.points.map(function (point) {\n            return _this.getRotatedPoint(point);\n        });\n    };\n    Model.prototype.getPolygons = function () {\n        return this.polygons;\n    };\n    Model.prototype.getPolygonsV2 = function () {\n        var _this = this;\n        return this.polygons.map(function (indexes) {\n            var points = indexes.map(function (index) {\n                return _this.points[index];\n            });\n            return new Polygon(points);\n        }).flat();\n    };\n    Model.prototype.getPolygonsV3 = function () {\n        var _this = this;\n        return this.polygons.map(function (indexes) {\n            var points = indexes.map(function (index) {\n                return _this.points[index];\n            });\n            return new Polygon(points).triangulate();\n        }).flat();\n    };\n    Model.prototype.getMaterial = function () {\n        return this.material;\n    };\n    Model.prototype.setMaterial = function (material) {\n        this.material = material;\n    };\n    Model.prototype.getScale = function () {\n        return this.scale;\n    };\n    Model.prototype.setScale = function (scale) {\n        this.scale = Math.min(Math.max(scale, 1), 0);\n    };\n    Model.prototype.setDirection = function (direction) {\n        this.rotationDirection = Vector.normalize(direction);\n        this.rotationMatrix = this.calcDirectionMatrix();\n    };\n    Model.prototype.rotate = function (angle, direction) {\n        this.rotation = angle;\n        if (direction) {\n            this.rotationDirection = Vector.normalize(direction);\n        }\n        this.rotationMatrix = this.calcDirectionMatrix();\n    };\n    Model.prototype.calcDirectionMatrix = function () {\n        return calcDirectionMatrix(this.rotationDirection, this.rotation);\n    };\n    Model.prototype.getRotatedPoint = function (point) {\n        return {\n            x: point.x * this.rotationMatrix[0][0] + point.y * this.rotationMatrix[0][1] + point.z * this.rotationMatrix[0][2],\n            y: point.x * this.rotationMatrix[1][0] + point.y * this.rotationMatrix[1][1] + point.z * this.rotationMatrix[1][2],\n            z: point.x * this.rotationMatrix[2][0] + point.y * this.rotationMatrix[2][1] + point.z * this.rotationMatrix[2][2]\n        };\n    };\n    return Model;\n}(Observable));\nexport { Model };\n","export var calcDirectionMatrix = function (direction, angle) {\n    var rotationAngle = angle * (Math.PI / 180);\n    var cosAngle = Math.cos(rotationAngle);\n    var sinAngle = Math.sin(rotationAngle);\n    return [\n        [\n            cosAngle + Math.pow(direction.x, 2) * (1 - cosAngle),\n            direction.x * direction.y * (1 - cosAngle) - direction.z * sinAngle,\n            direction.x * direction.z * (1 - cosAngle) + direction.y * sinAngle\n        ],\n        [\n            direction.y * direction.x * (1 - cosAngle) + direction.z * sinAngle,\n            cosAngle + Math.pow(direction.y, 2) * (1 - cosAngle),\n            direction.y * direction.z * (1 - cosAngle) - direction.x * sinAngle\n        ],\n        [\n            direction.z * direction.x * (1 - cosAngle) - direction.y * sinAngle,\n            direction.z * direction.y * (1 - cosAngle) + direction.x * sinAngle,\n            cosAngle + Math.pow(direction.z, 2) * (1 - cosAngle)\n        ]\n    ];\n};\n","var Color = /** @class */ (function () {\n    function Color() {\n    }\n    Color.parse = function (color) {\n        return Color.parseRgb(color)\n            || Color.parseHsl(color)\n            || Color.parseHsla(color)\n            || [1, 1, 1, 1];\n    };\n    Color.parseRgb = function (color) {\n        if (color[0] !== \"#\") {\n            return null;\n        }\n        return [\n            parseInt(color.slice(1, 3), 16) / 255,\n            parseInt(color.slice(3, 5), 16) / 255,\n            parseInt(color.slice(5, 7), 16) / 255,\n            1\n        ];\n    };\n    Color.parseHsl = function (color) {\n        var hslRegex = /hsl\\((\\d+),\\s*([\\d.]+)%,\\s*([\\d.]+)%\\)/;\n        var match = color.match(hslRegex);\n        if (!match) {\n            return null;\n        }\n        var hue = parseInt(match[1]) / 60;\n        var saturation = parseInt(match[2]) / 100;\n        var lightness = parseInt(match[3]) / 100;\n        var c = (1 - Math.abs(2 * lightness - 1)) * saturation;\n        var x = c * (1 - Math.abs(hue % 2 - 1));\n        var m = lightness - c / 2;\n        var r = 0, g = 0, b = 0;\n        if (0 <= hue && hue < 1) {\n            r = c;\n            g = x;\n            b = 0;\n        }\n        else if (1 <= hue && hue < 2) {\n            r = x;\n            g = c;\n            b = 0;\n        }\n        else if (2 <= hue && hue < 3) {\n            r = 0;\n            g = c;\n            b = x;\n        }\n        else if (3 <= hue && hue < 4) {\n            r = 0;\n            g = x;\n            b = c;\n        }\n        else if (4 <= hue && hue < 5) {\n            r = x;\n            g = 0;\n            b = c;\n        }\n        else if (5 <= hue && hue < 6) {\n            r = c;\n            g = 0;\n            b = x;\n        }\n        return [r + m, g + m, b + m, 1];\n    };\n    Color.parseHsla = function (color) {\n        var hslaRegex = /hsla\\((\\d+),\\s*([\\d.]+)%,\\s*([\\d.]+)%,\\s*([\\d.]+)\\)/;\n        var match = color.match(hslaRegex);\n        if (!match) {\n            return null;\n        }\n        var hue = parseInt(match[1]) / 60;\n        var saturation = parseInt(match[2]) / 100;\n        var lightness = parseInt(match[3]) / 100;\n        var alpha = parseFloat(match[4]);\n        var c = (1 - Math.abs(2 * lightness - 1)) * saturation;\n        var x = c * (1 - Math.abs(hue % 2 - 1));\n        var m = lightness - c / 2;\n        var r = 0, g = 0, b = 0;\n        if (0 <= hue && hue < 1) {\n            r = c;\n            g = x;\n            b = 0;\n        }\n        else if (1 <= hue && hue < 2) {\n            r = x;\n            g = c;\n            b = 0;\n        }\n        else if (2 <= hue && hue < 3) {\n            r = 0;\n            g = c;\n            b = x;\n        }\n        else if (3 <= hue && hue < 4) {\n            r = 0;\n            g = x;\n            b = c;\n        }\n        else if (4 <= hue && hue < 5) {\n            r = x;\n            g = 0;\n            b = c;\n        }\n        else if (5 <= hue && hue < 6) {\n            r = c;\n            g = 0;\n            b = x;\n        }\n        return [r + m, g + m, b + m, alpha];\n    };\n    return Color;\n}());\nexport { Color };\n","var __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        if (typeof b !== \"function\" && b !== null)\n            throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nimport { mat4 } from \"gl-matrix\";\nimport { Context } from \"../core/Context\";\nimport { Color } from \"../core/Color\";\nvar WebGLContext = /** @class */ (function (_super) {\n    __extends(WebGLContext, _super);\n    function WebGLContext() {\n        var _this = _super.call(this) || this;\n        _this.canvas = document.createElement(\"canvas\");\n        var context = _this.canvas.getContext(\"webgl\");\n        if (!context) {\n            throw new Error();\n        }\n        _this.context = context;\n        _this.program = _this.initShaderProgram();\n        return _this;\n    }\n    Object.defineProperty(WebGLContext.prototype, \"domElement\", {\n        get: function () {\n            return this.canvas;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    WebGLContext.prototype.initShaderProgram = function () {\n        var vertexShader = this.loadShader(this.context.VERTEX_SHADER, \"\\n            attribute vec4 aVertexPosition;\\n            attribute vec4 aVertexColor;\\n\\n            uniform mat4 uModelViewMatrix;\\n            uniform mat4 uProjectionMatrix;\\n\\n            varying lowp vec4 vColor;\\n\\n            void main(void) {\\n                gl_Position = uProjectionMatrix * uModelViewMatrix * aVertexPosition;\\n                vColor = aVertexColor;\\n            }\\n        \");\n        var fragmentShader = this.loadShader(this.context.FRAGMENT_SHADER, \"\\n            varying lowp vec4 vColor;\\n\\n            void main(void) {\\n                gl_FragColor = vColor;\\n            }\\n        \");\n        var shaderProgram = this.context.createProgram();\n        if (!shaderProgram) {\n            throw new Error(\"Failed to create program\");\n        }\n        this.context.attachShader(shaderProgram, vertexShader);\n        this.context.attachShader(shaderProgram, fragmentShader);\n        this.context.linkProgram(shaderProgram);\n        if (!this.context.getProgramParameter(shaderProgram, this.context.LINK_STATUS)) {\n            throw new Error(\"Failed to link program: \" + this.context.getProgramInfoLog(shaderProgram));\n        }\n        return shaderProgram;\n    };\n    WebGLContext.prototype.loadShader = function (type, source) {\n        var shader = this.context.createShader(type);\n        if (!shader) {\n            throw new Error(\"Failed to create shader\");\n        }\n        this.context.shaderSource(shader, source);\n        this.context.compileShader(shader);\n        if (!this.context.getShaderParameter(shader, this.context.COMPILE_STATUS)) {\n            throw new Error(\"Failed to compile shader: \" + this.context.getShaderInfoLog(shader));\n        }\n        return shader;\n    };\n    WebGLContext.prototype.setWidth = function (width) {\n        _super.prototype.setWidth.call(this, width);\n        this.canvas.width = width;\n    };\n    WebGLContext.prototype.setHeight = function (height) {\n        _super.prototype.setHeight.call(this, height);\n        this.canvas.height = height;\n    };\n    WebGLContext.prototype.clear = function () {\n        this.context.clearColor(0.0, 0.0, 0.0, 1.0); // Clear to black, fully opaque\n        this.context.clearDepth(1.0); // Clear everything\n        this.context.enable(this.context.DEPTH_TEST); // Enable depth testing\n        this.context.depthFunc(this.context.LEQUAL); // Near things obscure far things\n        // Clear the canvas before we start drawing on it.\n        this.context.clear(this.context.COLOR_BUFFER_BIT | this.context.DEPTH_BUFFER_BIT);\n        // this.updateV2();\n    };\n    WebGLContext.prototype.getModelViewMatrix = function (angle) {\n        var modelViewMatrix = mat4.create();\n        mat4.translate(modelViewMatrix, // destination matrix\n        modelViewMatrix, // matrix to translate\n        [-0.0, 0.0, -6.0]); // amount to translate\n        mat4.rotate(modelViewMatrix, // destination matrix\n        modelViewMatrix, // matrix to rotate\n        angle, // amount to rotate in radians\n        [0, 0, 1]); // axis to rotate around (Z)\n        mat4.rotate(modelViewMatrix, // destination matrix\n        modelViewMatrix, // matrix to rotate\n        angle * 0.7, // amount to rotate in radians\n        [0, 1, 0]); // axis to rotate around (Y)\n        mat4.rotate(modelViewMatrix, // destination matrix\n        modelViewMatrix, // matrix to rotate\n        angle * 0.3, // amount to rotate in radians\n        [1, 0, 0]); // axis to rotate around (X)\n        return modelViewMatrix;\n    };\n    WebGLContext.prototype.render = function (models, camera) {\n        //\n    };\n    WebGLContext.prototype.renderPolygons = function (polygons, camera) {\n        var _this = this;\n        for (var _i = 0, polygons_1 = polygons; _i < polygons_1.length; _i++) {\n            var polygon = polygons_1[_i];\n            polygon.triangulate(this.debug).forEach(function (polygon) {\n                _this.drawPolygon(polygon, camera);\n            });\n        }\n    };\n    WebGLContext.prototype.drawPolygon = function (polygon, camera) {\n        var positionBuffer = this.context.createBuffer();\n        var positions = polygon.points.map(function (point) {\n            return [point.x, point.y, point.z];\n        }).flat();\n        this.context.bindBuffer(this.context.ARRAY_BUFFER, positionBuffer);\n        this.context.bufferData(this.context.ARRAY_BUFFER, new Float32Array(positions), this.context.STATIC_DRAW);\n        var color = Color.parse(polygon.color || \"\");\n        if (this.debug) {\n            console.log(polygon.color, color);\n        }\n        var colors = polygon.points.map(function () {\n            return color;\n        }).flat();\n        var colorBuffer = this.context.createBuffer();\n        this.context.bindBuffer(this.context.ARRAY_BUFFER, colorBuffer);\n        this.context.bufferData(this.context.ARRAY_BUFFER, new Float32Array(colors), this.context.STATIC_DRAW);\n        var indexBuffer = this.context.createBuffer();\n        var indices = Array.from({ length: polygon.points.length }).map(function (_, index) {\n            return index;\n        });\n        this.context.bindBuffer(this.context.ELEMENT_ARRAY_BUFFER, indexBuffer);\n        this.context.bufferData(this.context.ELEMENT_ARRAY_BUFFER, new Uint16Array(indices), this.context.STATIC_DRAW);\n        this.context.bindBuffer(this.context.ARRAY_BUFFER, positionBuffer);\n        this.context.vertexAttribPointer(this.context.getAttribLocation(this.program, \"aVertexPosition\"), 3, this.context.FLOAT, false, 0, 0);\n        this.context.enableVertexAttribArray(this.context.getAttribLocation(this.program, \"aVertexPosition\"));\n        this.context.bindBuffer(this.context.ARRAY_BUFFER, colorBuffer);\n        this.context.vertexAttribPointer(this.context.getAttribLocation(this.program, \"aVertexColor\"), 4, this.context.FLOAT, false, 0, 0);\n        this.context.enableVertexAttribArray(this.context.getAttribLocation(this.program, \"aVertexColor\"));\n        this.context.bindBuffer(this.context.ELEMENT_ARRAY_BUFFER, indexBuffer);\n        this.context.useProgram(this.program);\n        this.context.uniformMatrix4fv(this.context.getUniformLocation(this.program, \"uProjectionMatrix\"), false, new Float32Array(camera.getProjectionMatrix().flat()));\n        this.context.uniformMatrix4fv(this.context.getUniformLocation(this.program, \"uModelViewMatrix\"), false, this.getModelViewMatrix(0.0));\n        {\n            var vertexCount = polygon.points.length;\n            this.context.drawElements(this.context.TRIANGLES, vertexCount, this.context.UNSIGNED_SHORT, 0);\n            this.context.viewport(0, 0, this.width, this.height);\n        }\n    };\n    return WebGLContext;\n}(Context));\nexport { WebGLContext };\n","var DataProvider = /** @class */ (function () {\n    function DataProvider() {\n        this.models = [];\n    }\n    DataProvider.prototype.getModels = function () {\n        return this.models;\n    };\n    DataProvider.prototype.addModel = function (model) {\n        this.models.push(model);\n    };\n    return DataProvider;\n}());\nexport { DataProvider };\n","import { SVGContext } from \"../context/SVGContext\";\nimport { CanvasContext } from \"../context/CanvasContext\";\nimport { WebGLContext } from \"../context/WebGLContext\";\nimport { Camera } from \"./Camera\";\nimport { DataProvider } from \"./DataProvider\";\nimport { Polygon } from \"./Polygon\";\nvar Scene = /** @class */ (function () {\n    function Scene(context) {\n        this.isLooping = false;\n        this.isDebug = false;\n        this.models = [];\n        switch (context) {\n            case \"svg\":\n                this.context = new SVGContext();\n                break;\n            case \"canvas\":\n                this.context = new CanvasContext();\n                break;\n            case \"webgl\":\n                this.context = new WebGLContext();\n                break;\n            default:\n                this.context = context;\n                break;\n        }\n        this.dataProvider = new DataProvider();\n        this.camera = new Camera(this.context);\n    }\n    Scene.prototype.getContext = function () {\n        return this.context;\n    };\n    Scene.prototype.getCamera = function () {\n        return this.camera;\n    };\n    Scene.prototype.requestPointerLock = function () {\n        this.context.domElement.requestPointerLock();\n    };\n    Scene.prototype.debug = function () {\n        this.isDebug = true;\n        this.camera.setDebug(true);\n        this.context.setDebug(true);\n    };\n    Scene.prototype.debugger = function () {\n        if (this.isDebug) {\n            this.isDebug = false;\n            this.camera.setDebug(false);\n            this.context.setDebug(false);\n            return true;\n        }\n        return this.isDebug;\n    };\n    Scene.prototype.update = function () {\n        var _this = this;\n        this.context.clear();\n        var polygons = this.models.map(function (model, modelIndex) {\n            var position = model.getPosition();\n            var points = model.getPoints();\n            return model.getPolygons().map(function (indexes, polygonIndex) {\n                var polygonPoints = indexes.map(function (index) {\n                    var point = points[index];\n                    return _this.camera.transformPointToCameraView({\n                        x: position.x + point.x - _this.camera.getPosition().x,\n                        y: position.y + point.y - _this.camera.getPosition().y,\n                        z: position.z + point.z - _this.camera.getPosition().z\n                    });\n                });\n                var polygon = new Polygon(polygonPoints);\n                polygon.setId(\"\".concat(model.getId(), \".\").concat(polygonIndex));\n                polygon.color = \"hsla(\".concat((modelIndex) * 100 + polygonIndex * 15, \", 100%, 50%, 1)\");\n                return polygon;\n            });\n        }).flat();\n        // this.context.render(this.models, this.camera);\n        this.context.renderPolygons(polygons, this.camera);\n        if (this.debugger())\n            debugger;\n    };\n    Scene.prototype.add = function (model, position, id) {\n        if (id) {\n            model.setId(id);\n        }\n        if (position) {\n            model.setPosition(position);\n        }\n        this.models.push(model);\n        this.context.addModel(model);\n        this.dataProvider.addModel(model);\n    };\n    Scene.prototype.remove = function (model) {\n        this.models = this.models.filter(function (m) {\n            return m !== model;\n        });\n        this.context.removeModel(model);\n    };\n    Scene.prototype.run = function (root) {\n        var _a = root.getBoundingClientRect(), width = _a.width, height = _a.height;\n        while (root.firstChild) {\n            root.removeChild(root.firstChild);\n        }\n        root.append(this.context.domElement);\n        this.context.setSizes(width, height);\n        if (!this.isLooping) {\n            this.isLooping = true;\n            this.loop();\n        }\n    };\n    Scene.prototype.stop = function () {\n        this.isLooping = false;\n    };\n    Scene.prototype.loop = function () {\n        var _this = this;\n        if (!this.isLooping) {\n            return;\n        }\n        window.requestAnimationFrame(function () {\n            _this.update();\n            _this.loop();\n        });\n    };\n    return Scene;\n}());\nexport { Scene };\n","var __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        if (typeof b !== \"function\" && b !== null)\n            throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nimport { Model } from \"../core/Model\";\nvar Sphere = /** @class */ (function (_super) {\n    __extends(Sphere, _super);\n    function Sphere(radius, position) {\n        var _this = _super.call(this, position) || this;\n        _this.radius = radius;\n        return _this;\n    }\n    return Sphere;\n}(Model));\nexport { Sphere };\n","var Dispatchable = /** @class */ (function () {\n    function Dispatchable() {\n        this.listeners = {};\n    }\n    Dispatchable.prototype.addEventListener = function (type, listener) {\n        if (!this.listeners[type]) {\n            this.listeners[type] = [];\n        }\n        this.listeners[type].push(listener);\n    };\n    Dispatchable.prototype.removeEventListener = function (type, listener) {\n        if (this.listeners[type]) {\n            var index = this.listeners[type].indexOf(listener);\n            if (index !== -1) {\n                this.listeners[type].splice(index, 1);\n            }\n        }\n    };\n    Dispatchable.prototype.dispatch = function (event) {\n        if (this.listeners[event.type]) {\n            this.listeners[event.type].forEach(function (listener) { return listener(event); });\n        }\n    };\n    return Dispatchable;\n}());\nexport { Dispatchable };\n","var __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        if (typeof b !== \"function\" && b !== null)\n            throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nimport { Model } from \"../core/Model\";\nvar Cube = /** @class */ (function (_super) {\n    __extends(Cube, _super);\n    function Cube(width, height, depth, position) {\n        var _this = _super.call(this, position) || this;\n        _this.width = width;\n        _this.height = height;\n        _this.depth = depth;\n        _this.points = [\n            { x: -width / 2, y: -height / 2, z: -depth / 2 }, // 0\n            { x: width / 2, y: -height / 2, z: -depth / 2 }, // 1\n            { x: width / 2, y: height / 2, z: -depth / 2 }, // 2\n            { x: -width / 2, y: height / 2, z: -depth / 2 }, // 3\n            { x: -width / 2, y: -height / 2, z: depth / 2 }, // 4\n            { x: width / 2, y: -height / 2, z: depth / 2 }, // 5\n            { x: width / 2, y: height / 2, z: depth / 2 }, // 6\n            { x: -width / 2, y: height / 2, z: depth / 2 } // 7\n        ];\n        _this.polygons = [\n            [0, 1, 2, 3],\n            [1, 2, 6, 5],\n            [4, 5, 6, 7],\n            [0, 4, 7, 3],\n            [7, 3, 2, 6],\n            [0, 1, 5, 4]\n        ];\n        return _this;\n    }\n    return Cube;\n}(Model));\nexport { Cube };\n","import {\n    useFormContext,\n    useController\n} from \"react-hook-form\";\n\n\ntype Props<P = unknown> = P & {\n    label?: string;\n    required?: boolean;\n    name: string;\n};\n\nexport const useControl = (props: Props) => {\n    const {\n        name\n    } = props;\n\n    const {\n        formState: {\n            isSubmitting\n        }\n    } = useFormContext();\n\n    const {\n        field\n    } = useController({\n        name\n    });\n\n    return {\n        field: {\n            ...field,\n            ...isSubmitting ? {disabled: true} : {}\n        }\n    };\n};\n\nexport {Props as ControlProps};\n","import React from \"react\";\nimport Button from \"@mui/material/Button\";\nimport ButtonGroup from \"@mui/material/ButtonGroup\";\n\nimport {useControl, ControlProps} from \"src/hooks\";\n\n\ntype Props = ControlProps<{\n    options: {\n        disabled?: boolean;\n        label: string;\n        value: string;\n    }[];\n}>;\n\nconst ButtonGroupControl: React.FC<Props> = (props) => {\n    const {\n        label,\n        options,\n        name\n    } = props;\n\n    const {\n        field: {\n            disabled,\n            value,\n            onChange\n        }\n    } = useControl({\n        name\n    });\n\n    return (\n        <ButtonGroup\n          title={label}\n          disabled={disabled}>\n            {options.map((option, index) => {\n                return (\n                    <Button\n                      key={index}\n                      color={option.value === value ? \"success\" : \"info\"}\n                      disabled={option.disabled}\n                      value={option.value}\n                      onClick={() => onChange(option.value)}>\n                        {option.label}\n                    </Button>\n                );\n            })}\n        </ButtonGroup>\n    );\n};\n\n\nexport {ButtonGroupControl};\n","import React, {useCallback} from \"react\";\nimport Grid from \"@mui/material/Grid\";\nimport Slider, {SliderProps} from \"@mui/material/Slider\";\n\nimport {useControl, ControlProps} from \"src/hooks\";\n\n\ntype Props = ControlProps<{\n    label?: SliderProps[\"title\"];\n    marks?: SliderProps[\"marks\"];\n    min?: SliderProps[\"min\"];\n    max?: SliderProps[\"max\"];\n    step?: SliderProps[\"step\"];\n}>;\n\nconst SliderControl: React.FC<Props> = (props) => {\n    const {\n        required,\n        label,\n        marks,\n        min,\n        max,\n        step,\n        name\n    } = props;\n\n    const {\n        field: {\n            value = 0,\n            onChange\n        }\n    } = useControl({\n        required,\n        name\n    });\n\n    const handleChange = useCallback((e: Event, value: number | number[]) => {\n        onChange(value as number);\n    }, [onChange]);\n\n    return (\n        <Grid container spacing={1} alignItems=\"center\">\n            <Grid item container width={55} justifyContent=\"flex-end\">\n                <Grid item>\n                    {value.toFixed(2)}\n                </Grid>\n            </Grid>\n\n            <Grid item xs>\n                <Slider\n                  title={label}\n                  marks={marks}\n                  min={min}\n                  max={max}\n                  step={step}\n                  value={value}\n                  onChange={handleChange} />\n            </Grid>\n        </Grid>\n    );\n};\n\n\nexport {SliderControl};\n","import React, {useCallback, ChangeEvent} from \"react\";\nimport Switch from \"@mui/material/Switch\";\n\nimport {useControl, ControlProps} from \"src/hooks\";\n\n\ntype Props = ControlProps;\n\nconst SwitchControl: React.FC<Props> = (props) => {\n    const {\n        required,\n        name\n    } = props;\n\n    const {\n        field: {\n            value = false,\n            disabled,\n            ref,\n            onChange,\n            onBlur\n        }\n    } = useControl({\n        required,\n        name\n    });\n\n    const handleChange = useCallback((e: ChangeEvent, checked: boolean) => {\n        onChange(checked);\n    }, [onChange]);\n\n    return (\n        <Switch\n          ref={ref}\n          disabled={disabled}\n          checked={value}\n          onBlur={onBlur}\n          onChange={handleChange} />\n    );\n};\n\n\nexport {SwitchControl};\n","import React from \"react\";\nimport Grid from \"@mui/material/Grid\";\n\nimport {\n    ButtonGroupControl,\n    SliderControl,\n    SwitchControl\n} from \"src/views/controls\";\n\n\nconst ConfigForm: React.FC = () => {\n    return (\n        <Grid container spacing={1}>\n            <Grid item xs={12}>\n                <ButtonGroupControl\n                  label=\"Context\"\n                  options={[\n                    {label: \"SVG\", value: \"svg\"},\n                    {label: \"Canvas\", value: \"canvas\"},\n                    {label: \"WebGL\", value: \"webgl\"}\n                  ]}\n                  name=\"context\" />\n            </Grid>\n\n            <Grid item xs={12}>\n                <SwitchControl\n                  name=\"isRunning\" />\n            </Grid>\n\n            <Grid item xs={12}>\n                <SliderControl\n                  label=\"FOV\"\n                  min={0}\n                  max={200}\n                  name=\"fov\" />\n            </Grid>\n\n            <Grid item xs={12}>\n                <SliderControl\n                  label=\"Pitch\"\n                  min={-90}\n                  max={90}\n                  name=\"pitch\" />\n            </Grid>\n\n            <Grid item xs={12}>\n                <SliderControl\n                  label=\"Yaw\"\n                  min={-180}\n                  max={180}\n                  name=\"yaw\" />\n            </Grid>\n\n            <Grid container item xs={6} spacing={1}>\n                <Grid item xs={12}>\n                    <SliderControl\n                      label=\"Position X\"\n                      marks={[\n                        {label: \"-100\", value: -100},\n                        {label: \"0\", value: 0},\n                        {label: \"100\", value: 100}\n                      ]}\n                      min={-100}\n                      max={100}\n                      name=\"position.x\" />\n                </Grid>\n\n                <Grid item xs={12}>\n                    <SliderControl\n                      label=\"Position Y\"\n                      marks={[\n                        {label: \"-100\", value: -100},\n                        {label: \"0\", value: 0},\n                        {label: \"100\", value: 100}\n                      ]}\n                      min={-100}\n                      max={100}\n                      name=\"position.y\" />\n                </Grid>\n\n                <Grid item xs={12}>\n                    <SliderControl\n                      label=\"Position Z\"\n                      marks={[\n                        {label: \"-100\", value: -100},\n                        {label: \"0\", value: 0},\n                        {label: \"100\", value: 100}\n                      ]}\n                      min={-100}\n                      max={100}\n                      name=\"position.z\" />\n                </Grid>\n            </Grid>\n\n            <Grid container item xs={6} spacing={1}>\n                <Grid item xs={12}>\n                    <SliderControl\n                      label=\"Direction X\"\n                      marks={[\n                        {label: \"-1\", value: -1},\n                        {label: \"0\", value: 0},\n                        {label: \"1\", value: 1}\n                      ]}\n                      min={-1}\n                      max={1}\n                      step={0.01}\n                      name=\"direction.x\" />\n                </Grid>\n\n                <Grid item xs={12}>\n                    <SliderControl\n                      label=\"Direction Y\"\n                      marks={[\n                        {label: \"-1\", value: -1},\n                        {label: \"0\", value: 0},\n                        {label: \"1\", value: 1}\n                      ]}\n                      min={-1}\n                      max={1}\n                      step={0.01}\n                      name=\"direction.y\" />\n                </Grid>\n\n                <Grid item xs={12}>\n                    <SliderControl\n                      label=\"Direction Z\"\n                      marks={[\n                        {label: \"-1\", value: -1},\n                        {label: \"0\", value: 0},\n                        {label: \"1\", value: 1}\n                      ]}\n                      min={-1}\n                      max={1}\n                      step={0.01}\n                      name=\"direction.z\" />\n                </Grid>\n            </Grid>\n        </Grid>\n    );\n};\n\n\nexport {ConfigForm};\n","import React, {\n    useState,\n    useRef,\n    useCallback,\n    useEffect,\n    createContext,\n    PropsWithChildren\n} from \"react\";\nimport Drawer from \"@mui/material/Drawer\";\nimport Box from \"@mui/material/Box\";\nimport {Point, Observable} from \"motor-js\";\n\nimport {Form, FormElement} from \"src/views/blocks\";\nimport {ConfigForm} from \"../ConfigForm\";\n\n\ntype EventMap = {\n    changeContext: {data: Data;};\n    changeRunning: {data: Data;};\n    changeFov: {data: Data;};\n    changePitch: {data: Data;};\n    changeYaw: {data: Data;};\n    changePosition: {data: Data;};\n    changeDirection: {data: Data;};\n};\n\ntype Data = {\n    context: \"svg\" | \"canvas\" | \"webgl\";\n    isRunning: boolean;\n    fov: number;\n    pitch: number;\n    yaw: number;\n    position: Point;\n    direction: Point;\n};\n\ntype ContextType = Data & {\n    setRunning: (isRunning: boolean) => void,\n    setFov: (fov: number) => void;\n    setPitch: (pitch: number) => void;\n    setYaw: (yaw: number) => void;\n    setDirection: (direction: Point) => void;\n    setPosition: (position: Point) => void;\n    setContext: (context: Data[\"context\"]) => void;\n    addEventListener: Observable<EventMap>[\"addEventListener\"];\n    removeEventListener: Observable<EventMap>[\"removeEventListener\"];\n};\n\nconst Context = createContext<ContextType>({\n    context: \"webgl\",\n    setContext() {},\n    isRunning: false,\n    setRunning() {},\n    fov: 100,\n    setFov() {},\n    pitch: 0,\n    setPitch() {},\n    yaw: 0,\n    setYaw() {},\n    direction: {x: 1, y: 0, z: 0},\n    setDirection() {},\n    position: {x: 0, y: 0, z: 0},\n    setPosition() {},\n    addEventListener() {},\n    removeEventListener() {}\n});\n\ntype Props = PropsWithChildren;\n\nconst ConfigProvider: React.FC<Props> = (props) => {\n    const {children} = props;\n\n    const [isOpen, setOpen] = useState(false);\n    const [isRunning, setRunning] = useState(true);\n    const [context, setContext] = useState<\"svg\"|\"canvas\"|\"webgl\">(\"canvas\");\n    const [fov, setFov] = useState(45);\n    const [pitch, setPitch] = useState(0);\n    const [yaw, setYaw] = useState(0);\n    const [position, setPosition] = useState<Point>({x: 0, y: 0, z: 300});\n    const [direction, setDirection] = useState<Point>({x: 0, y: 0, z: -1});\n    const observer = useRef<Observable<EventMap>>(new Observable<EventMap>());\n    const formRef = useRef<FormElement>(null);\n\n    const handleClose = useCallback(() => {\n        setOpen(false);\n    }, []);\n\n    const handleDiff = useCallback((prev: any, next: any): boolean => {\n        return JSON.stringify(prev) !== JSON.stringify(next);\n    }, []);\n\n    const handlePositionChange = useCallback((position: Point) => {\n        setPosition(position);\n    }, []);\n\n    const handleDirectionChange = useCallback((direction: Point) => {\n        setDirection(direction);\n    }, []);\n\n    const handleAddEventListener: Observable<EventMap>[\"addEventListener\"] = useCallback((type, listener) => {\n        observer.current.addEventListener(type, listener);\n    }, []);\n\n    const handleRemoveEventListener: Observable<EventMap>[\"removeEventListener\"] = useCallback((type, listener) => {\n        observer.current.removeEventListener(type, listener);\n    }, []);\n\n    const handleSubmit = useCallback((data: Data) => {\n        if(handleDiff(context, data.context)) {\n            setContext(data.context);\n            observer.current.emit(\"changeContext\", {data});\n        }\n\n        if(handleDiff(isRunning, data.isRunning)) {\n            setRunning(data.isRunning);\n            observer.current.emit(\"changeRunning\", {data});\n        }\n\n        if(handleDiff(position, data.position)) {\n            setPosition(data.position);\n            observer.current.emit(\"changePosition\", {data});\n        }\n\n        if(handleDiff(direction, data.direction)) {\n            setDirection(data.direction);\n            observer.current.emit(\"changeDirection\", {data});\n        }\n\n        if(handleDiff(fov, data.fov)) {\n            setFov(data.fov);\n            observer.current.emit(\"changeFov\", {data});\n        }\n\n        if(handleDiff(pitch, data.pitch)) {\n            setPitch(data.pitch);\n            observer.current.emit(\"changePitch\", {data});\n        }\n\n        if(handleDiff(yaw, data.yaw)) {\n            setYaw(data.yaw);\n            observer.current.emit(\"changeYaw\", {data});\n        }\n    }, [context, position, direction, fov, pitch, yaw, pitch]);\n\n    useEffect(() => {\n        const handleKeydown = (e: KeyboardEvent) => {\n            if(e.key === \"p\") {\n                setOpen((open) => !open);\n                e.preventDefault();\n            }\n        };\n\n        document.addEventListener(\"keydown\", handleKeydown);\n\n        return () => {\n            document.removeEventListener(\"keydown\", handleKeydown);\n        };\n    }, []);\n\n    return (\n        <Context.Provider\n          value={{\n            context,\n            setContext,\n            isRunning,\n            setRunning,\n            fov,\n            setFov,\n            pitch,\n            setPitch,\n            yaw,\n            setYaw,\n            direction,\n            setDirection: handleDirectionChange,\n            position,\n            setPosition: handlePositionChange,\n            addEventListener: handleAddEventListener,\n            removeEventListener: handleRemoveEventListener\n          }}>\n            <Drawer\n              sx={{\n                width: \"50vw\"\n              }}\n              PaperProps={{\n                sx: {\n                    width: \"50vw\",\n                    padding: 2\n                }\n              }}\n              open={isOpen}\n              anchor=\"right\"\n              onClose={handleClose}>\n                <Form\n                  ref={formRef}\n                  mode=\"onSubmit\"\n                  values={{\n                    context,\n                    isRunning,\n                    fov,\n                    pitch,\n                    yaw,\n                    position,\n                    direction\n                  }}\n                  shouldUnregister\n                  onChange={handleSubmit}>\n                    <Box sx={{paddingLeft: 2, paddingRight: 2}}>\n                        <ConfigForm />\n                    </Box>\n                </Form>\n            </Drawer>\n\n            {children}\n        </Context.Provider>\n    );\n};\n\n\nexport {\n    ConfigProvider,\n    Context as ConfigContext\n};\n","import {Model, Polygon, Point, BSPNode} from \"motor-js\";\n\n\nexport class Lines extends Model {\n    constructor(position?: Point) {\n        super(position);\n\n        this.points = [];\n        this.polygons = [];\n    }\n\n    public addPolygon(p: Polygon) {\n        const indexes: number[] = [];\n\n        for(let i = 0; i < p.points.length; i++) {\n            indexes.push(this.points.length);\n            this.points.push(p.points[i]);\n        }\n\n        this.polygons.push(indexes);\n    }\n\n    public addLine(start: Point, end: Point) {\n        const index = this.points.length;\n\n        this.points.push(start);\n        this.points.push(end);\n\n        this.polygons.push([index, index + 1]);\n    }\n\n    public getPolygons(): number[][] {\n        return this.polygons;\n    }\n}\n","import React, {\n    useState,\n    useRef,\n    useContext,\n    useCallback,\n    useEffect,\n    MouseEvent as RMouseEvent\n} from \"react\";\nimport {\n    Scene,\n    Cube,\n    Polygon,\n    CameraPositionChangeEvent,\n    CameraDirectionChangeEvent,\n    CameraFovChangeEvent\n} from \"motor-js\";\n\nimport {ConfigContext} from \"../ConfigProvider\";\nimport {Lines} from \"../../models/Lines\";\n\n\nconst PathBuilder: React.FC = () => {\n    const [isLocked, setLocked] = useState(false);\n    const rootRef = useRef(null);\n    const sceneRef = useRef<Scene>();\n    const config = useContext(ConfigContext);\n\n    const handleClick = useCallback(() => {\n        if(!sceneRef.current) {\n            return;\n        }\n\n        sceneRef.current.requestPointerLock();\n    }, []);\n\n    const handleContextMenu = useCallback((e: RMouseEvent) => {\n        const scene = sceneRef.current;\n\n        if(!scene) {\n            return;\n        }\n\n        console.clear();\n        scene.debug();\n\n        e.preventDefault();\n        e.stopPropagation();\n    }, []);\n\n    useEffect(() => {\n        if(!rootRef.current) {\n            return;\n        }\n\n        const scene = sceneRef.current = new Scene(config.context);\n        (window as any).scene = scene;\n        (window as any).context = scene.getContext();\n        (window as any).camera = scene.getCamera();\n        const camera = scene.getCamera();\n\n        camera.setPitch(config.pitch);\n        camera.setYaw(config.yaw);\n        camera.setPosition(config.position);\n        camera.setFov(config.fov);\n\n        const lines = new Lines({x: 0, y: 0, z: 0});\n\n        const a = new Polygon([\n            {x: -100, y: -10, z: -10},\n            {x: 0, y: 90, z: -10},\n            {x: 100, y: -10, z: -10}\n        ]);\n        a.setId(\"a\");\n\n        const b = new Polygon([\n            {x: -10, y: 0, z: -90},\n            {x: -10, y: 120, z: 0},\n            {x: -10, y: 0, z: 90}\n        ]);\n        b.setId(\"b\");\n\n        const c = new Polygon([\n            {x: -30, y: 0, z: -20},\n            {x: -20, y: 50, z: 0},\n            {x: -10, y: 0, z: -10}\n        ]);\n        c.setId(\"c\");\n\n        // lines.addPolygon(b);\n        // lines.addPolygon(a);\n        // lines.addPolygon(c);\n        // lines.addPolygon(new Polygon([\n        //     {x: 100, y: -30, z: 100},\n        //     {x: 100, y: -30, z: -100},\n        //     {x: -100, y: -30, z: -100},\n        //     {x: -100, y: -30, z: 100}\n        // ]));\n        lines.addPolygon(new Polygon([\n            {x: -100, y: 100, z: 0},\n            {x: 0, y: 0, z: 0},\n            {x: 100, y: 100, z: 0},\n            {x: 100, y: -100, z: 0},\n            {x: -100, y: -100, z: 0}\n        ]));\n\n        // scene.add(new Cube(100, 100, 100), {x: 0, y: 0, z: 0}, \"cube\");\n        // scene.add(new Cube(200, 1, 200), {x: 0, y: -100, z: 0}, \"ground\");\n        lines.setId(\"lines\");\n\n        // scene.add(lines);\n\n        scene.add(new Cube(100, 100, 100), {x: 0, y: 0, z: 0}, \"cube\");\n        // scene.add(new Cube(200, 1, 200), {x: 0, y: -55, z: 0}, \"ground\");\n        // scene.add(new Cube(1, 400, 400), {x: -120, y: 0, z: 0}, \"fance\");\n\n        // scene.add(new Cube(1000, 1000, 1000), {x: 0, y: 0, z: 0}, \"cube\");\n\n        // for(let i = -7; i <= 7; i++) {\n        //     for(let j = -7; j <= 7; j++) {\n        //         scene.add(new Cube(200, 1, 200), {x: 200 * i, y: -2000, z: 200 * j});\n        //         scene.add(new Cube(200, 1, 200), {x: 200 * i, y: 2000, z: 200 * j});\n        //     }\n        // }\n\n        scene.run(rootRef.current);\n\n        return () => {\n            scene.stop();\n        };\n    }, [config.context]);\n\n    useEffect(() => {\n        const handleLockChange = () => {\n            const locked = !!document.pointerLockElement;\n\n            setLocked(locked);\n        };\n\n        const handleF = (e: KeyboardEvent) => {\n            if(!sceneRef.current) {\n                return;\n            }\n\n            if(e.key !== \"f\") {\n                return;\n            }\n\n            console.clear();\n            sceneRef.current.debug();\n\n            e.preventDefault();\n        };\n\n        const handleChangeContext = (e: KeyboardEvent) => {\n            if(!sceneRef.current) {\n                return;\n            }\n\n            if(!e.altKey) {\n                return;\n            }\n\n            switch(e.key) {\n                case \"1\":\n                    config.setContext(\"svg\");\n                    break;\n\n                case \"2\":\n                    config.setContext(\"canvas\");\n                    break;\n\n                case \"3\":\n                    config.setContext(\"webgl\");\n                    break;\n\n                default:\n                    return;\n            }\n\n            e.preventDefault();\n        };\n\n        document.addEventListener(\"pointerlockchange\", handleLockChange);\n        document.addEventListener(\"keydown\", handleF);\n        document.addEventListener(\"keydown\", handleChangeContext);\n\n        return () => {\n            document.removeEventListener(\"pointerlockchange\", handleLockChange);\n            document.removeEventListener(\"keydown\", handleF);\n            document.removeEventListener(\"keydown\", handleChangeContext);\n        };\n    }, []);\n\n    useEffect(() => {\n        let forwardInterval: NodeJS.Timeout,\n            backInterval: NodeJS.Timeout,\n            leftInterval: NodeJS.Timeout,\n            rightInterval: NodeJS.Timeout,\n            upInterval: NodeJS.Timeout,\n            downInterval: NodeJS.Timeout;\n\n        const handleDown = (e: KeyboardEvent) => {\n            if(!sceneRef.current) {\n                return;\n            }\n\n            const scene = sceneRef.current;\n            const camera = scene.getCamera();\n            let position = camera.getPosition();\n\n            switch(e.key) {\n                case \"ArrowUp\":\n                    camera.setPosition({\n                        ...position,\n                        z: position.z + 1\n                    });\n                    break;\n\n                case \"ArrowDown\":\n                    camera.setPosition({\n                        ...position,\n                        z: position.z - 1\n                    });\n                    break;\n\n                case \"ArrowLeft\":\n                    camera.setPosition({\n                        ...position,\n                        x: position.x + 1\n                    });\n                    break;\n\n                case \"ArrowRight\":\n                    camera.setPosition({\n                        ...position,\n                        x: position.x - 1\n                    });\n                    break;\n\n                case \"w\": {\n                    clearInterval(forwardInterval);\n                    forwardInterval = setInterval(() => {\n                        const camera = scene.getCamera();\n\n                        camera.setPosition({\n                            x: camera.getPosition().x - camera.getDirection().x,\n                            y: camera.getPosition().y - camera.getDirection().y,\n                            z: camera.getPosition().z - camera.getDirection().z\n                        });\n                    }, 0);\n\n                    e.preventDefault();\n                    e.stopPropagation();\n                    break;\n                }\n\n                case \"a\": {\n                    clearInterval(leftInterval);\n                    leftInterval = setInterval(() => {\n                        const camera = scene.getCamera();\n\n                        camera.setPosition({\n                            x: camera.getPosition().x + camera.getDirectionLeft().x,\n                            y: camera.getPosition().y + camera.getDirectionLeft().y,\n                            z: camera.getPosition().z + camera.getDirectionLeft().z\n                        });\n                    }, 0);\n                    e.preventDefault();\n                    e.stopPropagation();\n                    break;\n                }\n\n                case \"d\": {\n                    clearInterval(rightInterval);\n                    rightInterval = setInterval(() => {\n                        const camera = scene.getCamera();\n                        camera.setPosition({\n                            x: camera.getPosition().x - camera.getDirectionLeft().x,\n                            y: camera.getPosition().y - camera.getDirectionLeft().y,\n                            z: camera.getPosition().z - camera.getDirectionLeft().z\n                        });\n                    }, 0);\n                    e.preventDefault();\n                    e.stopPropagation();\n                    break;\n                }\n\n                case \"s\": {\n                    clearInterval(backInterval);\n                    backInterval = setInterval(() => {\n                        const camera = scene.getCamera();\n\n                        camera.setPosition({\n                            x: camera.getPosition().x + camera.getDirection().x,\n                            y: camera.getPosition().y + camera.getDirection().y,\n                            z: camera.getPosition().z + camera.getDirection().z\n                        });\n                    }, 0);\n\n                    e.preventDefault();\n                    e.stopPropagation();\n                    break;\n                }\n\n                case \"q\": {\n                    clearInterval(downInterval);\n                    downInterval = setInterval(() => {\n                        const camera = scene.getCamera();\n                        const position = camera.getPosition();\n\n                        camera.setPosition({\n                            ...position,\n                            y: position.y - 1\n                        });\n                    }, 0);\n\n                    e.preventDefault();\n                    e.stopPropagation();\n                    break;\n                }\n\n                case \"e\": {\n                    clearInterval(upInterval);\n                    upInterval = setInterval(() => {\n                        const camera = scene.getCamera();\n                        const position = camera.getPosition();\n\n                        camera.setPosition({\n                            ...position,\n                            y: position.y + 1\n                        });\n                    }, 0);\n                    e.preventDefault();\n                    e.stopPropagation();\n                    break;\n                }\n            }\n        };\n\n        const handleUp = (e: KeyboardEvent) => {\n            switch(e.key) {\n                case \"w\":\n                    clearInterval(forwardInterval);\n                    break;\n\n                case \"a\":\n                    clearInterval(leftInterval);\n                    break;\n\n                case \"d\":\n                    clearInterval(rightInterval);\n                    break;\n\n                case \"s\":\n                    clearInterval(backInterval);\n                    break;\n\n                case \"q\":\n                    clearInterval(downInterval);\n                    break;\n\n                case \"e\":\n                    clearInterval(upInterval);\n                    break;\n            }\n        };\n\n        document.addEventListener(\"keypress\", handleDown);\n        document.addEventListener(\"keyup\", handleUp);\n\n        return () => {\n            document.removeEventListener(\"keypress\", handleDown);\n            document.removeEventListener(\"keyup\", handleUp);\n        };\n    }, []);\n\n    useEffect(() => {\n        if(!isLocked) {\n            return;\n        }\n\n        const handleMove = (e: MouseEvent) => {\n            if(!sceneRef.current) {\n                return;\n            }\n\n            const camera = sceneRef.current.getCamera();\n\n            camera.setDirectionFromAngles(\n                camera.getPitch() + e.movementY * 0.1,\n                camera.getYaw() - e.movementX * 0.1\n            );\n        };\n\n        document.addEventListener(\"mousemove\", handleMove);\n\n        return () => {\n            document.removeEventListener(\"mousemove\", handleMove);\n        };\n    }, [isLocked]);\n\n    useEffect(() => {\n        if(!sceneRef.current) {\n            return;\n        }\n\n        const camera = sceneRef.current.getCamera();\n\n        const handlePositionChange = (e: CameraPositionChangeEvent) => {\n            const {position} = e;\n\n            config.setPosition(position);\n        };\n\n        const handleChangeDirection = (e: CameraDirectionChangeEvent) => {\n            const {\n                direction,\n                yaw,\n                pitch\n            } = e;\n\n            config.setDirection(direction);\n            config.setPitch(pitch);\n            config.setYaw(yaw);\n        };\n\n        const handleFovChange = (e: CameraFovChangeEvent) => {\n            const {\n                fov\n            } = e;\n\n            config.setFov(fov);\n        };\n\n        // const handlePitchChange = () => {};\n\n        camera.addEventListener(\"positionChange\", handlePositionChange);\n        camera.addEventListener(\"directionChange\", handleChangeDirection);\n        camera.addEventListener(\"fovChange\", handleFovChange);\n        // camera.addEventListener(\"\");\n\n        return () => {\n            camera.removeEventListener(\"positionChange\", handlePositionChange);\n            camera.removeEventListener(\"directionChange\", handleChangeDirection);\n            camera.removeEventListener(\"fovChange\", handleFovChange);\n        };\n    }, [config]);\n\n    useEffect(() => {\n        const handleRunningChange = (e) => {\n            if(!rootRef.current || !sceneRef.current) {\n                return;\n            }\n\n            const scene = sceneRef.current;\n\n            if(!e.data.isRunning) {\n                scene.stop();\n            }\n            else {\n                scene.run(rootRef.current);\n            }\n        };\n\n        const handleChangePosition = (e) => {\n            if(!sceneRef.current) {\n                return;\n            }\n\n            const camera = sceneRef.current.getCamera();\n\n            const {\n                data: {\n                    position\n                }\n            } = e;\n\n            camera.setPosition(position);\n        };\n\n        const handleDirectionChange = (e) => {\n            if(!sceneRef.current) {\n                return;\n            }\n\n            const camera = sceneRef.current.getCamera();\n\n            const {\n                data: {\n                    direction\n                }\n            } = e;\n\n            camera.setDirection(direction);\n        };\n\n        const handleFovChange = (e) => {\n            if(!sceneRef.current) {\n                return;\n            }\n\n            const camera = sceneRef.current.getCamera();\n\n            const {\n                data: {\n                    fov\n                }\n            } = e;\n\n            camera.setFov(fov);\n        };\n\n        const handlePitchChange = (e) => {\n            if(!sceneRef.current) {\n                return;\n            }\n\n            const camera = sceneRef.current.getCamera();\n\n            const {\n                data: {\n                    pitch\n                }\n            } = e;\n\n            camera.setPitch(pitch);\n        };\n\n        const handleYawChange = (e) => {\n            if(!sceneRef.current) {\n                return;\n            }\n\n            const camera = sceneRef.current.getCamera();\n\n            const {\n                data: {\n                    yaw\n                }\n            } = e;\n\n            camera.setYaw(yaw);\n        };\n\n        config.addEventListener(\"changeRunning\", handleRunningChange);\n        config.addEventListener(\"changePosition\", handleChangePosition);\n        config.addEventListener(\"changeDirection\", handleDirectionChange);\n        config.addEventListener(\"changeFov\", handleFovChange);\n        config.addEventListener(\"changeYaw\", handleYawChange);\n        config.addEventListener(\"changePitch\", handlePitchChange);\n\n        return () => {\n            config.removeEventListener(\"changeRunning\", handleRunningChange);\n            config.removeEventListener(\"changePosition\", handleChangePosition);\n            config.removeEventListener(\"changeDirection\", handleDirectionChange);\n            config.removeEventListener(\"changeFov\", handleFovChange);\n            config.removeEventListener(\"changeYaw\", handleYawChange);\n            config.removeEventListener(\"changePitch\", handlePitchChange);\n        };\n    }, [config]);\n\n    return (\n        <div\n          ref={rootRef}\n          style={{\n            width: \"100%\",\n            height: \"calc(100vh - 55px)\"\n          }}\n          onClick={handleClick}\n          onContextMenu={handleContextMenu} />\n    );\n};\n\n\nexport {PathBuilder};\n","import React from \"react\";\n\nimport {\n    ConfigProvider,\n    PathBuilder\n} from \"./blocks\";\n\n\nconst PathBuilderPage: React.FC = () => {\n    return (\n        <ConfigProvider>\n            <PathBuilder />\n        </ConfigProvider>\n    );\n};\n\n\nexport default PathBuilderPage;\n"],"names":["Context","this","width","height","fov","models","debug","prototype","setDebug","getWidth","getHeight","setSizes","setWidth","setHeight","getFov","setFov","addModel","model","push","removeModel","filter","m","Vector","x","y","z","Object","defineProperty","get","distance","enumerable","configurable","set","point","add","summary","multiply","by","sub","subtract","normalize","_a","toPoint","fromPoint","a","b","cross","Math","sqrt","pow","distanceBetween","v","length","magnitude","dot","angle","v1","v2","mag1","mag2","acos","intersectPlane","direction","v0","intersectPlaneV2","intersectPlaneV1","edge1","edge2","planeNormal","denominator","abs","t","normal","d","denom","intersectPolygon","polygon","getNormal","points","isNaN","isFinite","intersectPoint","console","log","i","p1","p2","side1","side2","crossProduct","getAngle","cosAngle","PI","areCoDirected","areCoDirectedV2","areCoDirectedV1","pt1","pt2","ratioX","ratioY","ratioZ","epsilon","cos","Polygon2D","getCenter","center","calcCenter","__spreadArray","to","from","pack","arguments","ar","l","Array","slice","call","concat","Polygon","calcNormal","setId","id","intersects","_i","axes_1","getNormals","axis","projection1","projection","projection2","max","min","smooth","p3","vector1","vector2","getVector1","getVector2","isOnSamePlane","p","isContainPoint","isContainPointV2","isContainPointV1","inside","dot00","dot01","dot02","dot11","dot12","invDenom","u","sum","a1","a2","vector","isContainPointV3","project","camera","map","projectPoint","project2","_this","projectedPoints","n","scaledN","scalar","scaleVector","dotProduct","projectPointOnPlane","isIntersect","A","B","intersect","before","after","isBefore","j","b1","b2","b3","ABefore","color","AAfter","normals","edge","triangulate","triangulateV1","polygons","hasCut","polygon_1","splice","BSPNode","front","back","sort","root","rest","rest_1","_b","intersects_1","type","classifyPolygon","isInFront","isInFrontV1","isInFrontV2","viewVector","traverse","render","traverseV1","traverseV2","frontFirst","p4","d3","d4","apply","__extends","extendStatics","setPrototypeOf","__proto__","hasOwnProperty","TypeError","String","__","constructor","create","CanvasContext","_super","canvas","document","createElement","context","getContext","NaN","setStrokeStyle","strokeStyle","setFillStyle","fillStyle","drawLine","start","end","lineWidth","beginPath","moveTo","lineTo","stroke","closePath","drawPolygon","fillRect","w","h","fillPolygon","fill","clear","clearRect","renderPolygons","bspNode","forEach","SVGContext","svg","createElementNS","setAttribute","createSVGElement","line","appendChild","rect","join","append","firstChild","removeChild","Observable","listeners","addEventListener","listener","removeEventListener","index","indexOf","emit","event","Camera","position","isDebug","pitch","yaw","roll","rotationMatrix","calcDirectionMatrix","getPosition","setPosition","up","right","newUp","calcCameraRotationMatrixV2","getProjectionMatrix","fieldOfView","aspect","projectionMatrix","mat4","matrix","transformPointToCameraView","projected","projectPointV2","projectPointV1","scale","getDirection","getDirectionLeft","setDirection","setDirectionFromAngles","pitchRadians","yawRadians","sin","getPitch","setPitch","getYaw","setYaw","getRoll","setRoll","Model","rotation","rotationDirection","getId","getPoints","getRotatedPoint","getPolygons","getPolygonsV2","indexes","flat","getPolygonsV3","getMaterial","material","setMaterial","getScale","setScale","rotate","rotationAngle","sinAngle","Color","parse","parseRgb","parseHsl","parseHsla","parseInt","match","hue","saturation","lightness","c","r","g","alpha","parseFloat","WebGLContext","Error","program","initShaderProgram","vertexShader","loadShader","VERTEX_SHADER","fragmentShader","FRAGMENT_SHADER","shaderProgram","createProgram","attachShader","linkProgram","getProgramParameter","LINK_STATUS","getProgramInfoLog","source","shader","createShader","shaderSource","compileShader","getShaderParameter","COMPILE_STATUS","getShaderInfoLog","clearColor","clearDepth","enable","DEPTH_TEST","depthFunc","LEQUAL","COLOR_BUFFER_BIT","DEPTH_BUFFER_BIT","getModelViewMatrix","modelViewMatrix","polygons_1","positionBuffer","createBuffer","positions","bindBuffer","ARRAY_BUFFER","bufferData","Float32Array","STATIC_DRAW","colors","colorBuffer","indexBuffer","indices","_","ELEMENT_ARRAY_BUFFER","Uint16Array","vertexAttribPointer","getAttribLocation","FLOAT","enableVertexAttribArray","useProgram","uniformMatrix4fv","getUniformLocation","vertexCount","drawElements","TRIANGLES","UNSIGNED_SHORT","viewport","DataProvider","getModels","Scene","isLooping","dataProvider","getCamera","requestPointerLock","domElement","debugger","update","modelIndex","polygonIndex","polygonPoints","remove","run","getBoundingClientRect","loop","stop","window","requestAnimationFrame","Dispatchable","dispatch","Sphere","radius","Cube","depth","useControl","props","name","formState","isSubmitting","useFormContext","field","useController","_objectSpread","disabled","ButtonGroupControl","label","options","value","onChange","_jsx","ButtonGroup","title","children","option","Button","onClick","SliderControl","required","marks","step","handleChange","useCallback","e","_jsxs","Grid","container","spacing","alignItems","item","justifyContent","toFixed","xs","Slider","SwitchControl","ref","onBlur","checked","Switch","ConfigForm","createContext","setContext","isRunning","setRunning","ConfigProvider","isOpen","setOpen","useState","observer","useRef","formRef","handleClose","handleDiff","prev","next","JSON","stringify","handlePositionChange","handleDirectionChange","handleAddEventListener","current","handleRemoveEventListener","handleSubmit","data","useEffect","handleKeydown","key","open","preventDefault","Provider","Drawer","sx","PaperProps","padding","anchor","onClose","Form","mode","values","shouldUnregister","Box","paddingLeft","paddingRight","Lines","super","addPolygon","addLine","PathBuilder","isLocked","setLocked","rootRef","sceneRef","config","useContext","ConfigContext","handleClick","handleContextMenu","scene","stopPropagation","lines","handleLockChange","locked","pointerLockElement","handleF","handleChangeContext","altKey","forwardInterval","backInterval","leftInterval","rightInterval","upInterval","downInterval","handleDown","clearInterval","setInterval","handleUp","handleMove","movementY","movementX","handleChangeDirection","handleFovChange","handleRunningChange","handleChangePosition","handlePitchChange","handleYawChange","style","onContextMenu","PathBuilderPage"],"sourceRoot":""}