{"version":3,"file":"static/js/752.771927fd.chunk.js","mappings":"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","sources":["pages/PathBuilderPage/blocks/InputSlider/index.tsx","pages/PathBuilderPage/index.tsx"],"sourcesContent":["import React, {useCallback} from \"react\";\nimport {Grid, Slider, SliderProps} from \"@mui/material\";\n\n\ntype Props = {\n    title?: SliderProps[\"title\"];\n    marks?: SliderProps[\"marks\"];\n    min?: SliderProps[\"min\"];\n    max?: SliderProps[\"max\"];\n    step?: number;\n    defaultValue?: SliderProps[\"defaultValue\"];\n    value?: number;\n    onChange?: (value: number) => void;\n};\n\nconst InputSlider: React.FC<Props> = (props) => {\n    const {\n        value,\n        onChange,\n        ...rest\n    } = props;\n\n    const handleChange = useCallback((e: Event, value: number|number[]) => {\n        if(!onChange) {\n            return;\n        }\n\n        onChange(value as number);\n    }, [onChange]);\n\n    return (\n        <Grid container spacing={2} alignItems=\"center\">\n            <Grid item width={50}>\n                {value}\n            </Grid>\n\n            <Grid item xs>\n                <Slider\n                  {...rest}\n                  value={value}\n                  onChange={handleChange} />\n            </Grid>\n        </Grid>\n    );\n};\n\n\nexport {InputSlider};\n","import React, {useState, useRef, useCallback, useEffect} from \"react\";\nimport {Container, Grid, Switch} from \"@mui/material\";\nimport {Scene, Cube, Point2D, Point} from \"motor-js\";\n\nimport {InputSlider} from \"./blocks\";\n\n\nconst PathBuilderPage: React.FC = () => {\n    const [isRunning, setRunning] = useState(true);\n    const [fov, setFov] = useState(100);\n    const [position, setPosition] = useState<Point>({x: 0, y: 0, z: 0});\n    const [direction, setDirection] = useState<Point>({x: 1, y: 0, z: 0});\n    const [pitch, setPitch] = useState(0);\n    const [yaw, setYaw] = useState(0);\n    const [angle, setAngle] = useState(0);\n    const canvasRef = useRef<HTMLCanvasElement>(null);\n    const rootRef = useRef<HTMLDivElement>(null);\n    const sceneRef = useRef<Scene>();\n\n    const handleChangeFov = useCallback((fov: number) => {\n        if(!sceneRef.current) {\n            return;\n        }\n\n        const scene = sceneRef.current;\n\n        scene.getCamera().setFov(fov);\n        setFov(fov);\n    }, []);\n\n    const getPointProject = useCallback((point: Point, direction: Point) => {\n        if(point.z === direction.z) {\n            return {\n                x: 0,\n                y: 0\n            };\n        }\n\n        const scale = direction.z / (direction.z + point.z);\n\n        return {\n            x: scale * (point.x - direction.x),\n            y: scale * (point.y - direction.y)\n        };\n    }, [position, direction]);\n\n    const handleChangeAngle = useCallback((angle: number) => {\n        if(!sceneRef.current) {\n            return;\n        }\n\n        const scene = sceneRef.current;\n\n        scene.getCamera().setAngle(angle);\n        setAngle(angle);\n    }, []);\n\n    const handleChangeDirection = useCallback((direction: Point) => {\n        if(!sceneRef.current) {\n            return;\n        }\n\n        const scene = sceneRef.current;\n\n        scene.getCamera().setDirection(direction);\n        setDirection(direction);\n    }, []);\n\n    const handleChangePosition = useCallback((position: Point) => {\n        if(!sceneRef.current) {\n            return;\n        }\n\n        const scene = sceneRef.current;\n\n        const camera = scene.getCamera();\n\n        camera.setPosition(position);\n        setPosition(position);\n    }, []);\n\n    const handleChangePitch = useCallback((pitch: number) => {\n        if(!sceneRef.current) {\n            return;\n        }\n\n        const camera = sceneRef.current.getCamera();\n\n        camera.setPitch(pitch);\n        setPitch(pitch);\n        setDirection(camera.getDirection());\n    }, []);\n\n    const handleChangeYaw = useCallback((yaw: number) => {\n        if(!sceneRef.current) {\n            return;\n        }\n\n        const camera = sceneRef.current.getCamera();\n\n        camera.setYaw(yaw);\n        setYaw(yaw);\n        setDirection(camera.getDirection());\n    }, []);\n\n    const rotatePoint = useCallback((point: Point, direction: Point) => {\n        let rotationAngle = 45 * (Math.PI / 180);\n\n        let cosAngle = Math.cos(rotationAngle);\n        let sinAngle = Math.sin(rotationAngle);\n\n        let rotationMatrix = [\n            [\n                cosAngle + direction.x ** 2 * (1 - cosAngle),\n                direction.x * direction.y * (1 - cosAngle) - direction.z * sinAngle,\n                direction.x * direction.z * (1 - cosAngle) + direction.y * sinAngle\n            ],\n            [\n                direction.y * direction.x * (1 - cosAngle) + direction.z * sinAngle,\n                cosAngle + direction.y ** 2 * (1 - cosAngle),\n                direction.y * direction.z * (1 - cosAngle) - direction.x * sinAngle\n            ],\n            [\n                direction.z * direction.x * (1 - cosAngle) - direction.y * sinAngle,\n                direction.z * direction.y * (1 - cosAngle) + direction.x * sinAngle,\n                cosAngle + direction.z ** 2 * (1 - cosAngle)\n            ]\n        ];\n\n        let rotatedPoint = {\n            x: rotationMatrix[0][0] * point.x + rotationMatrix[0][1] * point.y + rotationMatrix[0][2] * point.z,\n            y: rotationMatrix[1][0] * point.x + rotationMatrix[1][1] * point.y + rotationMatrix[1][2] * point.z,\n            z: rotationMatrix[2][0] * point.x + rotationMatrix[2][1] * point.y + rotationMatrix[2][2] * point.z\n        };\n\n        // console.log(\"rotationMatrix: \", rotationMatrix, \"rotatedPoint: \", rotatedPoint);\n\n        return rotatedPoint;\n    }, [direction]);\n\n    const handleMouseDown = useCallback(() => {\n        if(!sceneRef.current) {\n            return;\n        }\n\n        const scene = sceneRef.current;\n\n        const handleMove = (e: MouseEvent) => {\n            const camera = scene.getCamera();\n\n            // camera.getPitch() - e.movementY * 0.5,\n            camera.setDirectionFromAngles(\n                Math.max(Math.min(camera.getPitch() - e.movementY * 0.5, 90), -90),\n                camera.getYaw() + e.movementX * 0.5\n            );\n\n            setPitch(camera.getPitch());\n            setYaw(camera.getYaw());\n            setDirection(camera.getDirection());\n        };\n\n        const handleUp = () => {\n            document.removeEventListener(\"mousemove\", handleMove);\n            document.removeEventListener(\"mouseup\", handleUp);\n        };\n\n        document.addEventListener(\"mousemove\", handleMove);\n        document.addEventListener(\"mouseup\", handleUp);\n    }, []);\n\n    useEffect(() => {\n        if(!rootRef.current) {\n            return;\n        }\n\n        const scene = (window as any).scene = sceneRef.current = new Scene(\"svg\");\n\n        const camera = scene.getCamera();\n\n        camera.setFov(fov);\n        camera.setPosition(position);\n        camera.setDirection(direction);\n\n        scene.run(rootRef.current);\n\n        scene.add(new Cube(100, 100, 100), {x: 0, y: 0, z: 0});\n        scene.add(new Cube(200, 1, 200), {x: 0, y: -51, z: 0});\n\n        return () => {\n            scene.stop();\n        };\n    }, []);\n\n    useEffect(() => {\n        const handleKeydown = (e: KeyboardEvent) => {\n            if(!sceneRef.current) {\n                return;\n            }\n\n            const scene = sceneRef.current;\n            const position = scene.getCamera().getPosition();\n\n            switch(e.key) {\n                case \"ArrowUp\":\n                    handleChangePosition({\n                        ...position,\n                        z: position.z + 1\n                    });\n                    break;\n\n                case \"ArrowDown\":\n                    handleChangePosition({\n                        ...position,\n                        z: position.z - 1\n                    });\n                    break;\n\n                case \"ArrowLeft\":\n                    handleChangePosition({\n                        ...position,\n                        x: position.x + 1\n                    });\n                    break;\n\n                case \"ArrowRight\":\n                    handleChangePosition({\n                        ...position,\n                        x: position.x - 1\n                    });\n                    break;\n            }\n        };\n\n        document.addEventListener(\"keydown\", handleKeydown);\n\n        return () => {\n            document.removeEventListener(\"keydown\", handleKeydown);\n        };\n    }, [handleChangePosition]);\n\n    useEffect(() => {\n        if(!canvasRef.current) {\n            return;\n        }\n\n        const canvas = canvasRef.current;\n        const context = canvas.getContext(\"2d\");\n\n        if(!context) {\n            return;\n        }\n\n        const center = {x: 0, y: 0, z: 0};\n\n        const camera = {\n            x: -40,\n            y: -20,\n            z: -500\n        };\n\n        const drawPoint = (point: Point, color: string = \"#FFFFFF\") => {\n            const projected: Point2D = getPointProject(point, camera);\n            const size = 2;\n\n            console.log(\"projected\", projected);\n\n            context.fillStyle = color;\n            context.fillRect(canvas.width / 2 + (projected.x + camera.x) - size / 2, canvas.height / 2 - (projected.y + camera.y) - size / 2, size, size);\n        };\n\n        const drawLine = (pointStart: Point, pointEnd: Point, color = \"#FFFFFF\") => {\n            const start = getPointProject(pointStart, camera),\n                end = getPointProject(pointEnd, camera);\n\n            context.strokeStyle = color;\n            context.lineWidth = 1;\n            context.beginPath();\n            context.moveTo(canvas.width / 2 + start.x + camera.x, canvas.height / 2 - (start.y + camera.y));\n            context.lineTo(canvas.width / 2 + end.x + camera.x, canvas.height / 2 - (end.y + camera.y));\n            context.stroke();\n            context.closePath();\n        };\n\n        context.clearRect(0, 0, canvas.width, canvas.height);\n\n        drawLine({x: -150, y: 0, z: 0}, {x: 150, y: 0, z: 0});\n        drawLine({x: 0, y: -150, z: 0}, {x: 0, y: 150, z: 0});\n        drawLine({x: 0, y: 0, z: -150}, {x: 0, y: 0, z: 150});\n\n        // const line1Start: Point = {x: -50, y: 20, z: 0};\n        // const line1End: Point = {x: 50, y: 20, z: 0};\n        // const line2Start: Point = {x: 20, y: -20, z: 0};\n        // const line2End: Point = {x: 20, y: 50, z: 0};\n\n        // drawLine(line1Start, line1End, \"#990000\");\n        // drawLine(line2Start, line2End, \"#CC9900\");\n\n        // const v1: Point = {\n        //     x: line1End.x - line1Start.x,\n        //     y: line1End.y - line1Start.y,\n        //     z: line1End.z - line1Start.z\n        // };\n\n        // const v2: Point = {\n        //     x: line2End.x - line2Start.x,\n        //     y: line2End.y - line2Start.y,\n        //     z: line2End.z - line2Start.z\n        // };\n\n        // const cross: Point = {\n        //     x: v1.y * v2.z - v1.z * v2.y,\n        //     y: v1.z * v2.x - v1.x * v2.z,\n        //     z: v1.x * v2.y - v1.y * v2.x\n        // };\n\n        // const v3: Point = {\n        //     x: line2Start.x - line1Start.x,\n        //     y: line2Start.y - line1Start.y,\n        //     z: line2Start.z - line1Start.z\n        // };\n\n        // const den: number = v1.x * v2.y * v3.z\n        //     + v2.x * v3.y * v1.z\n        //     + v3.x * v1.y * v2.z\n        //     - v1.x * v3.y * v2.z\n        //     - v2.x * v1.y * v3.z\n        //     - v3.x * v2.y * v1.z;\n        // let t1 = ((line2Start.x - line1Start.x) * v2.y - (line2Start.y - line1Start.y) * v2.x) / (v1.x * v2.y - v1.y * v2.x);\n        // let t2 = ((P2.x - P1.x) * V1.y - (P2.y - P1.y) * V1.x) / (V1.x * V2.y - V1.y * V2.x);\n\n        // let r1 = {\n        //     x: line1Start.x + t1 * v1.x,\n        //     y: line1Start.y + t1 * v1.y,\n        //     z: line1Start.z + t1 * v1.z\n        // };\n\n        // drawPoint(v1, \"#DD00FF\");\n        // drawPoint(v2, \"#DDCC00\");\n        // drawPoint(v3, \"#00FF00\");\n        // drawPoint(cross, \"#FFFF00\");\n        // drawPoint(r1, \"#0000FF\");\n\n        // drawLine(v1, v2);\n        // drawLine(v2, cross);\n        // drawLine(cross, v1);\n\n        // console.log(v1, v2, v3, cross, den);\n        // console.log(\"getLineIntersection:\", getLineIntersection([{x: -100, y: 0, z: 0}, {x: 100, y: 0, z: 0}], [{x: 0, y: -100, z: 0}, {x: 0, y: 100, z: 0}]));\n\n        // drawLine(center, position, \"#FFFF00\");\n        // drawLine(center, direction, \"#FF0000\");\n\n        // const rotatedPosition = rotatePoint(position, direction);\n\n        // drawLine(center, rotatedPosition, \"#FF00FF\");\n    }, [position, direction]);\n\n    return (\n        <Container>\n            <Switch\n              checked={isRunning}\n              onChange={(e, checked) => {\n                setRunning(checked);\n              }} />\n\n            <InputSlider\n              title=\"FOV\"\n              min={0}\n              max={200}\n              value={fov}\n              onChange={handleChangeFov} />\n\n            <InputSlider\n              min={-90}\n              max={90}\n              title=\"Pitch\"\n              value={pitch}\n              onChange={handleChangePitch} />\n\n            <InputSlider\n              min={-180}\n              max={180}\n              title=\"Yaw\"\n              value={yaw}\n              onChange={handleChangeYaw} />\n\n            {/*<InputSlider\n              min={-360}\n              max={360}\n              title=\"Roll\"\n              value={angle}\n              onChange={handleChangeAngle} />*/}\n\n            <Grid container spacing={10}>\n                <Grid container item xs={6} spacing={1}>\n                    <Grid item xs={12}>\n                        <InputSlider\n                          min={-100}\n                          max={100}\n                          defaultValue={0}\n                          title=\"Position X\"\n                          marks={[\n                            {label: \"-100\", value: -100},\n                            {label: \"0\", value: 0},\n                            {label: \"100\", value: 100}\n                          ]}\n                          value={position.x}\n                          onChange={(value) => {\n                            handleChangePosition({\n                                ...position,\n                                x: value\n                            });\n                          }} />\n                    </Grid>\n\n                    <Grid item xs={12}>\n                        <InputSlider\n                          min={-100}\n                          max={100}\n                          marks={[\n                            {label: \"-100\", value: -100},\n                            {label: \"0\", value: 0},\n                            {label: \"100\", value: 100}\n                          ]}\n                          title=\"Position Y\"\n                          value={position.y}\n                          onChange={(value) => {\n                            handleChangePosition({\n                               ...position,\n                               y: value\n                            });\n                          }} />\n                    </Grid>\n\n                    <Grid item xs={12}>\n                        <InputSlider\n                          min={-100}\n                          max={100}\n                          marks={[\n                            {label: \"-100\", value: -100},\n                            {label: \"0\", value: 0},\n                            {label: \"100\", value: 100}\n                          ]}\n                          title=\"Position Z\"\n                          value={position.z}\n                          onChange={(value) => {\n                            handleChangePosition({\n                                ...position,\n                                z: value\n                            });\n                          }} />\n                    </Grid>\n                </Grid>\n\n                <Grid container item xs={6} spacing={1}>\n                    <Grid item xs={12}>\n                        <InputSlider\n                          min={-1}\n                          max={1}\n                          step={0.01}\n                          marks={[\n                            {label: \"-1\", value: -1},\n                            {label: \"0\", value: 0},\n                            {label: \"1\", value: 1}\n                          ]}\n                          title=\"Direction X\"\n                          value={direction.x}\n                          onChange={(value) => {\n                            handleChangeDirection({\n                                ...direction,\n                                x: value as number\n                            });\n                          }} />\n                    </Grid>\n\n                    <Grid item xs={12}>\n                        <InputSlider\n                          min={-1}\n                          max={1}\n                          step={0.01}\n                          marks={[\n                            {label: \"-1\", value: -1},\n                            {label: \"0\", value: 0},\n                            {label: \"1\", value: 1}\n                          ]}\n                          title=\"Direction Y\"\n                          value={direction.y}\n                          onChange={(value) => {\n                            handleChangeDirection({\n                               ...direction,\n                               y: value as number\n                            });\n                          }} />\n                    </Grid>\n\n                    <Grid item xs={12}>\n                        <InputSlider\n                          min={-1}\n                          max={1}\n                          step={0.01}\n                          marks={[\n                            {label: \"-1\", value: -1},\n                            {label: \"0\", value: 0},\n                            {label: \"1\", value: 1}\n                          ]}\n                          title=\"Direction Z\"\n                          value={direction.z}\n                          onChange={(value) => {\n                            handleChangeDirection({\n                                ...direction,\n                                z: value as number\n                            });\n                          }} />\n                    </Grid>\n                </Grid>\n            </Grid>\n\n            <Grid container spacing={1}>\n                <Grid item xs={12}>\n                    <div\n                      style={{\n                        width: \"100%\",\n                        height: \"300px\"\n                      }}\n                      ref={rootRef}\n                      onMouseDown={handleMouseDown} />\n                </Grid>\n\n                {/*<Grid item xs={4} display=\"flex\" justifyContent=\"flex-end\">\n                    <PathBuilder\n                      context=\"svg\"\n                      running={isRunning}\n                      fov={fov}\n                      position={position}\n                      direction={direction}\n                      angle={angle} />\n                </Grid>*/}\n\n                {/*<Grid item xs={4}>\n                    <PathBuilder\n                      context=\"canvas\"\n                      running={isRunning}\n                      fov={fov}\n                      position={position}\n                      direction={direction}\n                      angle={angle} />\n                </Grid>*/}\n\n                {/*<Grid item xs={6}>\n                    <canvas\n                      ref={canvasRef}\n                      width={400}\n                      height={400} />\n                </Grid>*/}\n\n                {/*<Grid item xs={6}>\n                    <pre>{JSON.stringify({fov, position, direction}, null, 4)}</pre>\n                </Grid>*/}\n            </Grid>\n        </Container>\n    );\n};\n\n\nexport default PathBuilderPage;\n"],"names":["InputSlider","props","value","onChange","rest","handleChange","useCallback","e","_jsxs","Grid","container","spacing","alignItems","children","_jsx","item","width","xs","Slider","PathBuilderPage","isRunning","setRunning","useState","fov","setFov","position","setPosition","x","y","z","direction","setDirection","pitch","setPitch","yaw","setYaw","angle","setAngle","canvasRef","useRef","rootRef","sceneRef","handleChangeFov","current","getCamera","getPointProject","point","scale","handleChangeDirection","handleChangePosition","handleChangePitch","camera","getDirection","handleChangeYaw","handleMouseDown","rotationAngle","Math","PI","cosAngle","cos","sinAngle","sin","rotationMatrix","scene","handleMove","setDirectionFromAngles","max","min","getPitch","movementY","getYaw","movementX","handleUp","document","removeEventListener","addEventListener","useEffect","window","Scene","run","add","Cube","stop","handleKeydown","getPosition","key","canvas","context","getContext","drawLine","pointStart","pointEnd","color","arguments","length","undefined","start","end","strokeStyle","lineWidth","beginPath","moveTo","height","lineTo","stroke","closePath","clearRect","Container","Switch","checked","title","defaultValue","marks","label","step","style","ref","onMouseDown"],"sourceRoot":""}