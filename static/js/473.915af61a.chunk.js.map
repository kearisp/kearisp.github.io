{"version":3,"file":"static/js/473.915af61a.chunk.js","mappings":"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","sources":["../packages/motor-js/lib/core/Context.js","../packages/motor-js/lib/context/CanvasContext.js","../packages/motor-js/lib/context/SVGContext.js","../packages/motor-js/lib/core/Vector.js","../packages/motor-js/lib/core/Polygon.js","../packages/motor-js/lib/core/BSPNode.js","../packages/motor-js/lib/events/Observable.js","../packages/motor-js/lib/core/Camera.js","../packages/motor-js/lib/utils/calcCameraRotationMatrix.js","../packages/motor-js/lib/core/Model.js","../packages/motor-js/lib/utils/calcDirectionMatrix.js","../packages/motor-js/lib/core/DataProvider.js","../packages/motor-js/lib/core/Scene.js","../packages/motor-js/lib/shapes/Sphere.js","../packages/motor-js/lib/events/Dispatchable.js","../packages/motor-js/lib/shapes/Cube.js","hooks/useControl.ts","controls/SliderControl/index.tsx","controls/SwitchControl/index.tsx","pages/PathBuilderPage/blocks/ConfigForm/index.tsx","pages/PathBuilderPage/blocks/ConfigProvider/index.tsx","pages/PathBuilderPage/models/Lines.ts","pages/PathBuilderPage/blocks/PathBuilder/index.tsx","pages/PathBuilderPage/index.tsx"],"sourcesContent":["var Context = /** @class */ (function () {\n    function Context() {\n        this.width = 0;\n        this.height = 0;\n    }\n    Context.prototype.getWidth = function () {\n        return this.width;\n    };\n    Context.prototype.getHeight = function () {\n        return this.height;\n    };\n    Context.prototype.setWidth = function (width) {\n        this.width = width;\n    };\n    Context.prototype.setHeight = function (height) {\n        this.height = height;\n    };\n    return Context;\n}());\nexport { Context };\n","var __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        if (typeof b !== \"function\" && b !== null)\n            throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nimport { Context } from \"../core/Context\";\nvar CanvasContext = /** @class */ (function (_super) {\n    __extends(CanvasContext, _super);\n    function CanvasContext() {\n        var _this = _super.call(this) || this;\n        _this.canvas = document.createElement(\"canvas\");\n        // @ts-ignore\n        _this.context = _this.canvas.getContext(\"2d\");\n        return _this;\n    }\n    CanvasContext.prototype.setStrokeStyle = function (color) {\n        this.context.strokeStyle = color;\n    };\n    CanvasContext.prototype.setFillStyle = function (color) {\n        this.context.fillStyle = color;\n    };\n    CanvasContext.prototype.drawLine = function (start, end) {\n        this.context.lineWidth = 0.5;\n        this.context.beginPath();\n        this.context.moveTo(start.x, start.y);\n        this.context.lineTo(end.x, end.y);\n        this.context.stroke();\n        this.context.closePath();\n    };\n    CanvasContext.prototype.fillRect = function (x, y, w, h) {\n        this.context.fillRect(x, y, w, h);\n    };\n    CanvasContext.prototype.fillPolygon = function (points) {\n        this.context.beginPath();\n        var start = points[0], rest = points.slice(1);\n        this.context.moveTo(start.x, start.y);\n        for (var i = 0; i < rest.length; i++) {\n            this.context.lineTo(rest[i].x, rest[i].y);\n        }\n        this.context.closePath();\n        this.context.stroke();\n        this.context.fill();\n    };\n    CanvasContext.prototype.clear = function () {\n        this.context.clearRect(0, 0, this.getWidth(), this.getHeight());\n    };\n    CanvasContext.prototype.requestPointerLock = function () {\n        return this.canvas.requestPointerLock();\n    };\n    CanvasContext.prototype.render = function (root) {\n        var _a = root.getBoundingClientRect(), width = _a.width, height = _a.height;\n        this.canvas.width = width;\n        this.canvas.height = height;\n        root.append(this.canvas);\n    };\n    return CanvasContext;\n}(Context));\nexport { CanvasContext };\n","var __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        if (typeof b !== \"function\" && b !== null)\n            throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nimport { Context } from \"../core/Context\";\nvar SVGContext = /** @class */ (function (_super) {\n    __extends(SVGContext, _super);\n    function SVGContext() {\n        var _this = _super.call(this) || this;\n        _this.strokeStyle = \"#FFFFFF\";\n        _this.fillStyle = \"#FFFFFF\";\n        _this.svg = document.createElementNS(\"http://www.w3.org/2000/svg\", \"svg\");\n        _this.svg.setAttribute(\"width\", \"100%\");\n        _this.svg.setAttribute(\"height\", \"100%\");\n        return _this;\n    }\n    SVGContext.prototype.createSVGElement = function (type) {\n        return document.createElementNS(\"http://www.w3.org/2000/svg\", type);\n    };\n    SVGContext.prototype.setStrokeStyle = function (color) {\n        this.strokeStyle = color;\n    };\n    SVGContext.prototype.setFillStyle = function (color) {\n        this.fillStyle = color;\n    };\n    SVGContext.prototype.drawLine = function (start, end) {\n        var line = document.createElementNS(\"http://www.w3.org/2000/svg\", \"line\");\n        line.setAttribute(\"x1\", \"\".concat(start.x));\n        line.setAttribute(\"y1\", \"\".concat(start.y));\n        line.setAttribute(\"x2\", \"\".concat(end.x));\n        line.setAttribute(\"y2\", \"\".concat(end.y));\n        line.setAttribute(\"stroke\", this.strokeStyle);\n        line.setAttribute(\"stroke-width\", \"1\");\n        this.svg.appendChild(line);\n    };\n    SVGContext.prototype.fillRect = function (x, y, w, h) {\n        var rect = document.createElementNS(\"http://www.w3.org/2000/svg\", \"rect\");\n        rect.setAttribute(\"x\", \"\".concat(x));\n        rect.setAttribute(\"y\", \"\".concat(y));\n        rect.setAttribute(\"width\", \"\".concat(w));\n        rect.setAttribute(\"height\", \"\".concat(h));\n        rect.setAttribute(\"fill\", this.fillStyle);\n        this.svg.appendChild(rect);\n    };\n    SVGContext.prototype.fillPolygon = function (points) {\n        var polygon = document.createElementNS(\"http://www.w3.org/2000/svg\", \"polygon\");\n        polygon.setAttribute(\"style\", \"fill: \".concat(this.fillStyle));\n        polygon.setAttribute(\"points\", points.map(function (point) {\n            return \"\".concat(point.x, \",\").concat(point.y);\n        }).join(\" \"));\n        polygon.setAttribute(\"stroke-width\", \"0.9\");\n        polygon.setAttribute(\"stroke\", \"black\");\n        this.svg.append(polygon);\n    };\n    SVGContext.prototype.clear = function () {\n        while (this.svg.firstChild) {\n            this.svg.removeChild(this.svg.firstChild);\n        }\n    };\n    SVGContext.prototype.requestPointerLock = function () {\n        return this.svg.requestPointerLock();\n    };\n    SVGContext.prototype.render = function (root) {\n        root.append(this.svg);\n    };\n    return SVGContext;\n}(Context));\nexport { SVGContext };\n","var Vector = /** @class */ (function () {\n    function Vector(x, y, z) {\n        this.x = x;\n        this.y = y;\n        this.z = z;\n    }\n    Object.defineProperty(Vector.prototype, \"distance\", {\n        get: function () {\n            return Vector.distance(this);\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Vector.prototype.set = function (point) {\n        this.x = point.x;\n        this.y = point.y;\n        this.z = point.z;\n        return this;\n    };\n    Vector.prototype.add = function (point) {\n        this.set(Vector.summary(this, point));\n        return this;\n    };\n    Vector.prototype.multiply = function (by) {\n        this.set(Vector.multiply(this, by));\n        return this;\n    };\n    Vector.prototype.sub = function (point) {\n        this.set(Vector.subtract(this, point));\n        return this;\n    };\n    Vector.prototype.normalize = function () {\n        var _a = Vector.normalize(this), x = _a.x, y = _a.y, z = _a.z;\n        this.x = x;\n        this.y = y;\n        this.z = z;\n        return this;\n    };\n    Vector.prototype.toPoint = function () {\n        return {\n            x: this.x,\n            y: this.y,\n            z: this.z\n        };\n    };\n    Vector.fromPoint = function (point) {\n        return new Vector(point.x, point.y, point.z);\n    };\n    Vector.summary = function (a, b) {\n        return {\n            x: a.x + b.x,\n            y: a.y + b.y,\n            z: a.z + b.z\n        };\n    };\n    Vector.subtract = function (a, b) {\n        return {\n            x: a.x - b.x,\n            y: a.y - b.y,\n            z: a.z - b.z\n        };\n    };\n    Vector.cross = function (a, b) {\n        return {\n            x: a.y * b.z - a.z * b.y,\n            y: a.z * b.x - a.x * b.z,\n            z: a.x * b.y - a.y * b.x\n        };\n    };\n    Vector.distance = function (a) {\n        return Math.sqrt(Math.pow(a.x, 2) + Math.pow(a.y, 2) + Math.pow(a.z, 2));\n    };\n    Vector.normalize = function (a) {\n        var length = Math.sqrt(Math.pow(a.x, 2) + Math.pow(a.y, 2) + Math.pow(a.z, 2));\n        return {\n            x: a.x / length,\n            y: a.y / length,\n            z: a.z / length\n        };\n    };\n    Vector.magnitude = function (a) {\n        return Math.sqrt(Vector.dot(a, a));\n    };\n    Vector.angle = function (v1, v2) {\n        var mag1 = Vector.magnitude(v1), mag2 = Vector.magnitude(v2), dot = Vector.dot(v1, v2);\n        return Math.acos(dot / (mag1 * mag2));\n    };\n    Vector.multiply = function (a, by) {\n        return {\n            x: a.x * by,\n            y: a.y * by,\n            z: a.z * by\n        };\n    };\n    Vector.dot = function (a, b) {\n        return a.x * b.x + a.y * b.y + a.z * b.z;\n    };\n    Vector.intersectPlaneV1 = function (rayOrigin, rayVector, v0, v1, v2) {\n        var EPSILON = 0.0000001;\n        var edge1 = Vector.subtract(v1, v0);\n        var edge2 = Vector.subtract(v2, v0);\n        var planeNormal = Vector.cross(edge1, edge2);\n        var denominator = Vector.dot(planeNormal, rayVector);\n        if (Math.abs(denominator) < EPSILON) {\n            return null;\n        }\n        var t = Vector.dot(planeNormal, Vector.subtract(v0, rayOrigin)) / denominator;\n        if (t < 0) {\n            return null;\n        }\n        return Vector.summary(rayOrigin, Vector.multiply(rayVector, t));\n    };\n    Vector.intersectPlaneV2 = function (point, direction, v0, v1, v2) {\n        var edge1 = Vector.subtract(v1, v0);\n        var edge2 = Vector.subtract(v2, v0);\n        var normal = Vector.cross(edge1, edge2);\n        // Розрахунок відстані до площини\n        var d = -Vector.dot(normal, v0);\n        var denom = Vector.dot(normal, direction);\n        // Перевірка, чи вектор паралельний площині\n        if (Math.abs(denom) < 1e-6) {\n            return null;\n        }\n        var t = -(Vector.dot(normal, point) + d) / denom;\n        return Vector.summary(point, Vector.multiply(direction, t));\n    };\n    Vector.intersectPolygon = function (point, direction, polygon) {\n        var d = -(Vector.dot(polygon.getNormal(), polygon.points[0]));\n        var t = -(Vector.dot(polygon.getNormal(), point) + d) / Vector.dot(polygon.getNormal(), direction);\n        if (isNaN(t) || !isFinite(t)) {\n            return null;\n        }\n        var intersectPoint = Vector.summary(Vector.multiply(direction, t), point);\n        if (isNaN(intersectPoint.x) || !isFinite(intersectPoint.x)) {\n            console.log(point, t, intersectPoint);\n            debugger;\n        }\n        for (var i = 0; i < polygon.points.length; i++) {\n            var p1 = polygon.points[i];\n            var p2 = polygon.points[(i + 1) % polygon.points.length];\n            var side1 = Vector.subtract(p2, p1);\n            var side2 = Vector.subtract(intersectPoint, p1);\n            var crossProduct = Vector.cross(side1, side2);\n            if (Vector.dot(polygon.getNormal(), crossProduct) <= 1) {\n                return null;\n            }\n        }\n        return intersectPoint;\n    };\n    Vector.areCoDirected = function (pt1, pt2) {\n        // calculate ratios for each pair of coordinates\n        var ratioX = pt1.x / pt2.x;\n        var ratioY = pt1.y / pt2.y;\n        var ratioZ = pt1.z / pt2.z;\n        if (isNaN(ratioX) || isNaN(ratioY) || isNaN(ratioZ)) {\n            return false;\n        }\n        // check if each ratio is approximately equal to the other ratios (with epsilon precision)\n        var epsilon = Math.pow(10, -14);\n        if (Math.abs(ratioX - ratioY) > epsilon ||\n            Math.abs(ratioX - ratioZ) > epsilon ||\n            Math.abs(ratioY - ratioZ) > epsilon) {\n            return false;\n        }\n        // vectors are co-directed\n        return true;\n    };\n    return Vector;\n}());\nexport { Vector };\n","var __spreadArray = (this && this.__spreadArray) || function (to, from, pack) {\n    if (pack || arguments.length === 2) for (var i = 0, l = from.length, ar; i < l; i++) {\n        if (ar || !(i in from)) {\n            if (!ar) ar = Array.prototype.slice.call(from, 0, i);\n            ar[i] = from[i];\n        }\n    }\n    return to.concat(ar || Array.prototype.slice.call(from));\n};\nimport { Vector } from \"./Vector\";\nvar Polygon = /** @class */ (function () {\n    function Polygon(points, normal) {\n        this.points = points;\n        this.normal = !normal ? this.calcNormal() : normal;\n    }\n    Polygon.prototype.setId = function (id) {\n        this.id = id;\n    };\n    Polygon.prototype.intersects = function (polygon) {\n        var axes = __spreadArray(__spreadArray([], Polygon.getNormals(this.points), true), Polygon.getNormals(polygon.points), true);\n        for (var _i = 0, axes_1 = axes; _i < axes_1.length; _i++) {\n            var axis = axes_1[_i];\n            var projection1 = Polygon.projection(this.points, axis);\n            var projection2 = Polygon.projection(polygon.points, axis);\n            if (projection1.max < projection2.min || projection2.max < projection1.min) {\n                return false;\n            }\n            if (projection1.max === projection2.min || projection2.max === projection1.min) {\n                return false;\n            }\n        }\n        return true;\n    };\n    Polygon.prototype.smooth = function () {\n        return [];\n    };\n    Polygon.prototype.getNormal = function () {\n        return this.normal;\n    };\n    Polygon.prototype.calcNormal = function () {\n        var normal = {\n            x: 0,\n            y: 0,\n            z: 0\n        };\n        for (var i = 0; i < this.points.length; i++) {\n            var p1 = this.points[i];\n            var p2 = this.points[(i + 1) % this.points.length];\n            var p3 = this.points[(i + 2) % this.points.length];\n            var vector1 = Vector.subtract(p1, p2);\n            var vector2 = Vector.subtract(p1, p3);\n            var cross = Vector.cross(vector1, vector2);\n            normal = Vector.summary(normal, cross);\n        }\n        return Vector.normalize({\n            x: normal.x / this.points.length,\n            y: normal.y / this.points.length,\n            z: normal.z / this.points.length\n        });\n    };\n    Polygon.prototype.getCenter = function () {\n        var center = {\n            x: 0,\n            y: 0,\n            z: 0\n        };\n        for (var i = 0; i < this.points.length; i++) {\n            center = Vector.summary(this.points[i], center);\n        }\n        return {\n            x: center.x / this.points.length,\n            y: center.y / this.points.length,\n            z: center.z / this.points.length,\n        };\n    };\n    Polygon.prototype.isOnSamePlane = function (p) {\n        var point = this.points[0];\n        if (!point) {\n            return false;\n        }\n        var normal = this.getNormal();\n        var dot = Vector.dot(Vector.subtract(p, point), normal);\n        return Math.abs(dot) < 0.0001;\n    };\n    Polygon.prototype.isContainPointV1 = function (p) {\n        var inside = false;\n        for (var i = 0; i < this.points.length; i++) {\n            var p1 = this.points[i];\n            var p2 = this.points[(i + 1) % this.points.length];\n            var p3 = this.points[(i + 2) % this.points.length];\n            var v0 = Vector.subtract(p3, p1);\n            var v1 = Vector.subtract(p2, p1);\n            var v2 = Vector.subtract(p, p1);\n            var dot00 = Vector.dot(v0, v0);\n            var dot01 = Vector.dot(v0, v1);\n            var dot02 = Vector.dot(v0, v2);\n            var dot11 = Vector.dot(v1, v1);\n            var dot12 = Vector.dot(v1, v2);\n            var invDenom = 1 / (dot00 * dot11 - dot01 * dot01);\n            var u = (dot11 * dot02 - dot01 * dot12) * invDenom;\n            var v = (dot00 * dot12 - dot01 * dot02) * invDenom;\n            if ((u >= 0) && (v >= 0) && (u + v < 1)) {\n                inside = true;\n                break;\n            }\n        }\n        return inside;\n    };\n    Polygon.prototype.isContainPointV2 = function (point) {\n        var sum = 0;\n        for (var i = 0; i < this.points.length; i++) {\n            var a1 = this.points[i];\n            var a2 = this.points[(i + 1) % this.points.length];\n            var vector = Vector.subtract(a2, a1);\n            var t = Vector.dot(vector, Vector.subtract(point, a1)) / Vector.dot(vector, vector);\n            var epsilon = 0.000001;\n            if (t > epsilon && t < (1 - epsilon)) {\n                sum += Vector.angle(Vector.subtract(a2, point), Vector.subtract(a1, point));\n            }\n        }\n        return Math.abs(sum - Math.PI * 2) <= 0.01;\n    };\n    Polygon.prototype.isContainPointV3 = function (point) {\n        for (var i = 0; i < this.points.length; i++) {\n            var p1 = this.points[i];\n            var p2 = this.points[(i + 1) % this.points.length];\n            var side1 = Vector.subtract(p2, p1);\n            var side2 = Vector.subtract(point, p1);\n            var crossProduct = Vector.cross(side1, side2);\n            if (Vector.dot(this.getNormal(), crossProduct) <= -1) {\n                return false;\n            }\n        }\n        return true;\n    };\n    Polygon.isIntersect = function (A, B) {\n        return false;\n    };\n    Polygon.intersect = function (A, B, debug) {\n        var before = [];\n        var after = [];\n        var isBefore = true;\n        for (var i = 0; i < A.points.length; i++) {\n            var a1 = A.points[i];\n            var a2 = A.points[(i + 1) % A.points.length];\n            var vector = Vector.subtract(a2, a1);\n            if (isBefore) {\n                before.push(a1);\n            }\n            else {\n                after.push(a1);\n            }\n            for (var j = 0; j < B.points.length; j++) {\n                var b1 = B.points[j];\n                var b2 = B.points[(j + 1) % B.points.length];\n                var b3 = B.points[(j + 2) % B.points.length];\n                var intersectPoint = Vector.intersectPlaneV2(a1, vector, b1, b2, b3);\n                if (intersectPoint && Vector.distance(Vector.subtract(a1, intersectPoint)) < 0) {\n                    continue;\n                }\n                if (intersectPoint && A.isContainPointV3(intersectPoint)) {\n                    if (debug) {\n                        console.log(\"intersectPoint:\", intersectPoint);\n                    }\n                    before.push(intersectPoint);\n                    after.push(intersectPoint);\n                    if (debug) {\n                        debugger;\n                    }\n                    isBefore = !isBefore;\n                    break;\n                }\n            }\n        }\n        if (after.length === 0) {\n            return [A];\n        }\n        var ABefore = new Polygon(before);\n        ABefore.setId(\"\".concat(A.id, \".before\"));\n        ABefore.color = A.color;\n        var AAfter = new Polygon(after);\n        AAfter.setId(\"\".concat(A.id, \".after\"));\n        AAfter.color = A.color;\n        return [ABefore, AAfter];\n    };\n    Polygon.getNormals = function (points) {\n        var normals = [];\n        for (var i = 0; i < points.length; i++) {\n            var p1 = points[i];\n            var p2 = points[(i + 1) % points.length];\n            var edge = {\n                x: p2.x - p1.x,\n                y: p2.y - p1.y,\n                z: p2.z - p1.z\n            };\n            var normal = {\n                x: -edge.y,\n                y: edge.x,\n                z: edge.z\n            };\n            normals.push(normal);\n        }\n        return normals;\n    };\n    Polygon.projection = function (points, axis) {\n        var min = axis.x * points[0].x + axis.y * points[0].y;\n        var max = min;\n        for (var i = 1; i < points.length; i++) {\n            var p = axis.x * points[i].x + axis.y * points[i].y;\n            if (p < min) {\n                min = p;\n            }\n            else if (p > max) {\n                max = p;\n            }\n        }\n        return { min: min, max: max };\n    };\n    return Polygon;\n}());\nexport { Polygon };\n","import { Polygon } from \"./Polygon\";\nimport { Vector } from \"./Vector\";\nvar BSPNode = /** @class */ (function () {\n    function BSPNode(_a, debug) {\n        var root = _a[0], polygons = _a.slice(1);\n        if (debug === void 0) { debug = false; }\n        this.debug = false;\n        this.root = root;\n        this.debug = debug;\n        var front = [];\n        var back = [];\n        for (var _i = 0, polygons_1 = polygons; _i < polygons_1.length; _i++) {\n            var polygon = polygons_1[_i];\n            var intersects = Polygon.intersect(polygon, root, this.debug);\n            for (var _b = 0, intersects_1 = intersects; _b < intersects_1.length; _b++) {\n                var intersect = intersects_1[_b];\n                var type = this.classifyPolygon(intersect);\n                // if(this.debug) {\n                //     console.log(type, this.root.id, intersect.id);\n                // }\n                switch (type) {\n                    case \"front\":\n                        front.push(intersect);\n                        break;\n                    case \"back\":\n                        back.push(intersect);\n                        break;\n                    case \"coplanar\":\n                        // TODO\n                        if (this.debug) {\n                            console.log(type, this.root, intersect);\n                        }\n                        break;\n                }\n            }\n        }\n        this.front = front.length > 0 ? new BSPNode(front, this.debug) : null;\n        this.back = back.length > 0 ? new BSPNode(back, this.debug) : null;\n    }\n    BSPNode.prototype.classifyPolygon = function (polygon) {\n        // return this.classifyPolygonV1(polygon);\n        // return this.classifyPolygonV2(polygon);\n        // return this.classifyPolygonV3(polygon);\n        return this.classifyPolygonV4(polygon);\n    };\n    BSPNode.prototype.classifyPolygonV1 = function (polygon) {\n        var epsilon = 0.00001; // for numerical stability\n        // const epsilon = 0; // for numerical stability\n        var dot = Vector.dot(this.root.getNormal(), polygon.getNormal());\n        if (dot > epsilon) {\n            return \"front\";\n        }\n        else if (dot < -epsilon) {\n            return \"back\";\n        }\n        else {\n            return \"coplanar\";\n        }\n    };\n    BSPNode.prototype.classifyPolygonV2 = function (polygon) {\n        var dot = Vector.dot(this.root.getNormal(), polygon.getNormal());\n        if (dot > 0) {\n            return \"front\";\n        }\n        return \"back\";\n    };\n    BSPNode.prototype.classifyPolygonV3 = function (polygon) {\n        return this.root.getCenter().z > polygon.getCenter().z ? \"front\" : \"back\";\n    };\n    BSPNode.prototype.classifyPolygonV4 = function (polygon) {\n        return this.isInFrontV3(polygon) ? \"front\" : \"back\";\n    };\n    BSPNode.prototype.isInFront = function (position, direction) {\n        // const viewVector = Vector.subtract(this.root.points[0], position);\n        // const viewVector = Vector.subtract(this.root.getCenter(), position);\n        var viewVector = this.root.getCenter();\n        var viewDotProduct = Vector.dot(viewVector, direction);\n        if (viewDotProduct < 0) {\n            return false;\n        }\n        return Vector.dot(viewVector, this.root.getNormal()) > 0;\n    };\n    BSPNode.prototype.isInFrontV2 = function (polygon) {\n        return this.root.getCenter().z > polygon.getCenter().z;\n    };\n    BSPNode.prototype.isInFrontV3 = function (polygon) {\n        var vector = Vector.subtract(this.root.getCenter(), polygon.getCenter());\n        return Vector.dot(this.root.getNormal(), vector) < 0;\n        // const position = {\n        //     x: 0,\n        //     y: 0,\n        //     z: -100\n        // };\n        //\n        // return Vector.dot(position, this.root.getCenter()) < Vector.dot(position, polygon.getCenter());\n        // return Vector.dot(this.root.getCenter(), polygon.getCenter());\n    };\n    BSPNode.prototype.traverse = function (position, direction, render) {\n        if (!this.root) {\n            return;\n        }\n        // this.traverseV1(position, direction, render);\n        // this.traverseV2(position, direction, render);\n        // this.traverseV3(position, direction, render);\n        this.traverseV4(direction, render);\n    };\n    BSPNode.prototype.traverseV1 = function (position, direction, render) {\n        var type = this.isInFront(position, direction) ? \"front\" : \"back\";\n        // let type = this.isInFrontV2();\n        if (type === \"back\" && this.classifyPolygon(this.root) === \"back\") {\n            type = \"front\";\n        }\n        switch (type) {\n            case \"front\":\n                if (this.back) {\n                    this.back.traverseV1(position, direction, render);\n                }\n                render(this.root);\n                if (this.front) {\n                    this.front.traverseV1(position, direction, render);\n                }\n                break;\n            case \"back\":\n                if (this.front) {\n                    this.front.traverseV1(position, direction, render);\n                }\n                render(this.root);\n                if (this.back) {\n                    this.back.traverseV1(position, direction, render);\n                }\n                break;\n            // case \"coplanar\":\n            //     render(this.root);\n            //     break;\n        }\n    };\n    BSPNode.prototype.traverseV2 = function (position, direction, render) {\n        if (Vector.areCoDirected(direction, this.root.getNormal())) {\n            if (Vector.dot(position, this.root.getNormal()) >= 0) {\n                if (this.back) {\n                    this.back.traverseV2(position, direction, render);\n                }\n                render(this.root);\n                if (this.front) {\n                    this.front.traverseV2(position, direction, render);\n                }\n            }\n            else {\n                if (this.front) {\n                    this.front.traverseV2(position, direction, render);\n                }\n            }\n        }\n        else {\n            if (Vector.dot(position, this.root.getNormal()) >= 0) {\n                if (this.front) {\n                    this.front.traverseV2(position, direction, render);\n                }\n                render(this.root);\n                if (this.back) {\n                    this.back.traverseV2(position, direction, render);\n                }\n            }\n            else {\n                // if(this.front) {\n                //     this.front.traverseV2(position, direction, render);\n                // }\n                //\n                // render(this.root);\n                if (this.back) {\n                    this.back.traverseV2(position, direction, render);\n                }\n            }\n        }\n    };\n    BSPNode.prototype.traverseV3 = function (position, direction, render) {\n        if (Vector.areCoDirected(direction, this.root.getNormal())) {\n            if (Vector.dot(position, this.root.getNormal()) >= 0) {\n                if (this.front) {\n                    this.front.traverseV3(position, direction, render);\n                }\n            }\n            else {\n                if (this.front) {\n                    this.front.traverseV3(position, direction, render);\n                }\n                render(this.root);\n                if (this.back) {\n                    this.back.traverseV3(position, direction, render);\n                }\n            }\n        }\n        else {\n            if (Vector.dot(position, this.root.getNormal()) >= 0) {\n                if (this.back) {\n                    this.back.traverseV3(position, direction, render);\n                }\n                render(this.root);\n                if (this.front) {\n                    this.front.traverseV3(position, direction, render);\n                }\n            }\n            else {\n                if (this.back) {\n                    this.back.traverseV3(position, direction, render);\n                }\n            }\n        }\n    };\n    BSPNode.prototype.traverseV4 = function (direction, render) {\n        // if(this.debug) {\n        //     console.log(this.root.id, Vector.dot(direction, this.root.getNormal()));\n        // }\n        if (Vector.dot(this.root.getNormal(), direction) < 0) {\n            if (this.front) {\n                this.front.traverseV4(direction, render);\n            }\n            render(this.root);\n            if (this.back) {\n                this.back.traverseV4(direction, render);\n            }\n        }\n        else {\n            if (this.back) {\n                this.back.traverseV4(direction, render);\n            }\n            render(this.root);\n            if (this.front) {\n                this.front.traverseV4(direction, render);\n            }\n        }\n    };\n    return BSPNode;\n}());\nexport { BSPNode };\n","var Observable = /** @class */ (function () {\n    function Observable() {\n        this.listeners = {};\n    }\n    Observable.prototype.addEventListener = function (type, listener) {\n        if (!this.listeners[type]) {\n            this.listeners[type] = [];\n        }\n        this.listeners[type].push(listener);\n    };\n    Observable.prototype.removeEventListener = function (type, listener) {\n        if (this.listeners[type]) {\n            var index = this.listeners[type].indexOf(listener);\n            if (index !== -1) {\n                this.listeners[type].splice(index, 1);\n            }\n        }\n    };\n    Observable.prototype.emit = function (type, event) {\n        if (this.listeners[type]) {\n            this.listeners[type].forEach(function (listener) { return listener(event); });\n        }\n    };\n    return Observable;\n}());\nexport { Observable };\n","var __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        if (typeof b !== \"function\" && b !== null)\n            throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nvar __spreadArray = (this && this.__spreadArray) || function (to, from, pack) {\n    if (pack || arguments.length === 2) for (var i = 0, l = from.length, ar; i < l; i++) {\n        if (ar || !(i in from)) {\n            if (!ar) ar = Array.prototype.slice.call(from, 0, i);\n            ar[i] = from[i];\n        }\n    }\n    return to.concat(ar || Array.prototype.slice.call(from));\n};\nimport { Vector } from \"./Vector\";\nimport { Polygon } from \"./Polygon\";\nimport { Observable } from \"../events/Observable\";\nimport { BSPNode } from \"./BSPNode\";\nimport { calcCameraRotationMatrixV2 } from \"../utils/calcCameraRotationMatrix\";\nvar Camera = /** @class */ (function (_super) {\n    __extends(Camera, _super);\n    function Camera(context, dataProvider, position, direction) {\n        if (position === void 0) { position = { x: 0, y: 0, z: 0 }; }\n        if (direction === void 0) { direction = { x: 0, y: 0, z: 1 }; }\n        var _this = _super.call(this) || this;\n        _this.context = context;\n        _this.dataProvider = dataProvider;\n        _this.debug = false;\n        _this.isRunning = false;\n        _this.fov = 100;\n        _this.pitch = 0;\n        _this.yaw = 0;\n        _this.roll = 0;\n        _this.position = Vector.fromPoint(position);\n        _this.direction = Vector.fromPoint(direction);\n        _this.rotationMatrix = _this.calcDirectionMatrix();\n        return _this;\n    }\n    Camera.prototype.getPosition = function () {\n        return this.position;\n    };\n    Camera.prototype.setPosition = function (position) {\n        this.position.set(position);\n        this.rotationMatrix = this.calcDirectionMatrix();\n        this.emit(\"positionChange\", {\n            position: this.position\n        });\n    };\n    Camera.prototype.calcDirectionMatrix = function () {\n        return calcCameraRotationMatrixV2(this.position, this.direction);\n    };\n    Camera.prototype.rotatePoint = function (point) {\n        return this.transformPointToCameraView(point);\n    };\n    Camera.prototype.getModels = function () {\n        return this.dataProvider.getModels();\n    };\n    Camera.prototype.transformPointToCameraView = function (point) {\n        var matrix = this.rotationMatrix;\n        var x = point.x * matrix[0][0] + point.y * matrix[1][0] + point.z * matrix[2][0] + matrix[3][0];\n        var y = point.x * matrix[0][1] + point.y * matrix[1][1] + point.z * matrix[2][1] + matrix[3][1];\n        var z = point.x * matrix[0][2] + point.y * matrix[1][2] + point.z * matrix[2][2] + matrix[3][2];\n        // const w = point.x * matrix[0][3] + point.y * matrix[1][3] + point.z * matrix[2][3] + matrix[3][3];\n        var w = 1;\n        return {\n            x: x / w,\n            y: y / w,\n            z: z / w\n        };\n    };\n    Camera.prototype.projectPoint = function (point) {\n        var x = point.x, y = point.y, z = point.z;\n        if (z / 3 <= -this.fov) {\n            return { x: NaN, y: NaN };\n        }\n        var scale = this.fov / (this.fov + z / 3);\n        return {\n            x: scale * x,\n            y: scale * y\n        };\n    };\n    Camera.prototype.getFov = function () {\n        return this.fov;\n    };\n    Camera.prototype.setFov = function (fov) {\n        this.fov = fov;\n        this.emit(\"fovChange\", {\n            fov: this.fov\n        });\n    };\n    Camera.prototype.getDirection = function () {\n        return this.direction;\n    };\n    Camera.prototype.getDirectionLeft = function () {\n        return Vector.cross(this.direction, {\n            x: 0,\n            y: 1,\n            z: 0\n        });\n    };\n    Camera.prototype.setDirection = function (direction) {\n        this.direction.set(direction); //= Vector.normalize(direction);\n        this.rotationMatrix = this.calcDirectionMatrix();\n        this.emit(\"directionChange\", {\n            direction: this.direction,\n            pitch: this.pitch,\n            yaw: this.yaw\n        });\n    };\n    Camera.prototype.setDirectionFromAngles = function (pitch, yaw) {\n        this.pitch = Math.max(Math.min(pitch, 90), -90);\n        this.yaw = yaw;\n        var pitchRadians = this.pitch * (Math.PI / 180), yawRadians = this.yaw * (Math.PI / 180);\n        this.setDirection({\n            x: Math.cos(pitchRadians) * Math.sin(yawRadians),\n            y: Math.sin(pitchRadians),\n            z: Math.cos(pitchRadians) * Math.cos(yawRadians)\n        });\n    };\n    Camera.prototype.getYaw = function () {\n        // return Math.atan2(this.direction.z, this.direction.x) * (180 / Math.PI);\n        return this.yaw;\n    };\n    Camera.prototype.getPitch = function () {\n        // return Math.asin(this.direction.y) * (180 / Math.PI);\n        return this.pitch;\n    };\n    Camera.prototype.setPitch = function (pitch) {\n        this.setDirectionFromAngles(pitch, this.yaw);\n    };\n    Camera.prototype.setYaw = function (yaw) {\n        this.setDirectionFromAngles(this.pitch, yaw);\n    };\n    Camera.prototype.getRoll = function () {\n        return this.roll;\n    };\n    Camera.prototype.setRoll = function (roll) {\n        this.roll = roll;\n    };\n    Camera.prototype.update = function () {\n        var _this = this;\n        this.context.clear();\n        var polygons = this.getModels().reduce(function (polygons, model, modelIndex) {\n            var position = model.getPosition();\n            var points = model.getPoints();\n            return __spreadArray(__spreadArray([], polygons, true), model.getPolygons().map(function (indexes, polygonIndex) {\n                var polygonPoints = indexes.map(function (index) {\n                    var point = points[index];\n                    return _this.transformPointToCameraView({\n                        x: position.x + point.x - _this.position.x,\n                        y: position.y + point.y - _this.position.y,\n                        z: position.z + point.z - _this.position.z\n                    });\n                });\n                var polygon = new Polygon(polygonPoints);\n                polygon.setId(\"#\".concat(model.getId(), \".\").concat(polygonIndex));\n                polygon.color = \"hsl(\".concat((modelIndex) * 100 + polygonIndex * 15, \", 100%, 50%)\");\n                return polygon;\n            }), true);\n        }, []);\n        var bspNode = new BSPNode(polygons, this.debug);\n        bspNode.traverse({ x: 0, y: 0, z: 0 }, { x: 0, y: 0, z: -1 }, function (polygon) {\n            if (_this.debug) {\n                console.log(polygon.id);\n            }\n            var polygonPoints = polygon.points.map(function (point) {\n                var _a = _this.projectPoint(point), x = _a.x, y = _a.y;\n                return {\n                    x: _this.context.getWidth() / 2 + x,\n                    y: _this.context.getHeight() / 2 - y\n                };\n            }).filter(function (point) {\n                if (isNaN(point.x) || isNaN(point.y)) {\n                    debugger;\n                }\n                return !isNaN(point.x) && !isNaN(point.y);\n            });\n            if (polygonPoints.length > 0) {\n                // this.context.setStrokeStyle(\"#000000\");\n                _this.context.setStrokeStyle(\"#335555\");\n                _this.context.setFillStyle(polygon.color || \"#CC0000\");\n                _this.context.fillPolygon(polygonPoints);\n                // const center = this.projectPoint(polygon.getCenter());\n                // const normal = this.projectPoint(\n                //     Vector.summary(\n                //         polygon.getCenter(),\n                //         Vector.multiply(polygon.getNormal(), 50)\n                //     )\n                // );\n                //\n                // this.context.drawLine({\n                //     x: this.context.getWidth() / 2 + center.x,\n                //     y: this.context.getHeight() / 2 - center.y\n                // }, {\n                //     x: this.context.getWidth() / 2 + normal.x,\n                //     y: this.context.getHeight() / 2 - normal.y\n                // });\n            }\n        });\n        if (this.debug) {\n            this.debug = false;\n            debugger;\n        }\n    };\n    Camera.prototype.run = function () {\n        this.isRunning = true;\n        this.loop();\n    };\n    Camera.prototype.destroy = function () {\n        this.isRunning = false;\n    };\n    Camera.prototype.activateDebug = function () {\n        this.debug = true;\n    };\n    Camera.prototype.loop = function () {\n        var _this = this;\n        if (!this.isRunning) {\n            return;\n        }\n        requestAnimationFrame(function () {\n            _this.update();\n            _this.loop();\n        });\n    };\n    return Camera;\n}(Observable));\nexport { Camera };\n","import { Vector } from \"../core/Vector\";\nexport var calcCameraRotationMatrixV1 = function (eye, center, up) {\n    var f = Vector.normalize(Vector.subtract(center, eye));\n    var s = Vector.normalize(Vector.cross(f, up));\n    var u = Vector.cross(s, f);\n    return [\n        [s.x, u.x, -f.x, 0],\n        [s.y, u.y, -f.y, 0],\n        [s.z, u.z, -f.z, 0],\n        [-Vector.dot(s, eye), -Vector.dot(u, eye), Vector.dot(f, eye), 1]\n    ];\n};\nexport var calcCameraRotationMatrixV2 = function (position, direction, up) {\n    if (up === void 0) { up = { x: 0, y: 1, z: 0 }; }\n    var right = Vector.normalize(Vector.cross(up, direction));\n    var newUp = Vector.normalize(Vector.cross(direction, right));\n    return [\n        [right.x, newUp.x, direction.x, position.x],\n        [right.y, newUp.y, direction.y, position.y],\n        [right.z, newUp.z, direction.z, position.z],\n        [0, 0, 0, 1]\n    ];\n};\n","var __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        if (typeof b !== \"function\" && b !== null)\n            throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nimport { Vector } from \"./Vector\";\nimport { Polygon } from \"./Polygon\";\nimport { Observable } from \"../events/Observable\";\nimport { calcDirectionMatrix } from \"../utils/calcDirectionMatrix\";\nvar Model = /** @class */ (function (_super) {\n    __extends(Model, _super);\n    function Model(position) {\n        var _this = _super.call(this) || this;\n        _this.scale = 1;\n        _this.rotation = 0;\n        _this.rotationDirection = { x: 0, y: 1, z: 0 };\n        _this.points = [];\n        _this.polygons = [];\n        _this.position = position || { x: 0, y: 0, z: 0 };\n        _this.rotationMatrix = _this.calcDirectionMatrix();\n        return _this;\n    }\n    Model.prototype.getId = function () {\n        return this.id;\n    };\n    Model.prototype.setId = function (id) {\n        this.id = id;\n    };\n    Model.prototype.getPosition = function () {\n        return this.position;\n    };\n    Model.prototype.setPosition = function (position) {\n        this.position = position;\n    };\n    Model.prototype.getPoints = function () {\n        var _this = this;\n        return this.points.map(function (point) {\n            return _this.getRotatedPoint(point);\n        });\n    };\n    Model.prototype.getPolygons = function () {\n        return this.polygons;\n    };\n    Model.prototype.getPolygons2 = function () {\n        var _this = this;\n        return this.polygons.map(function (indexes) {\n            var points = indexes.map(function (index) {\n                return _this.points[index];\n            });\n            return new Polygon(points);\n        });\n    };\n    Model.prototype.getScale = function () {\n        return this.scale;\n    };\n    Model.prototype.setScale = function (scale) {\n        this.scale = Math.min(Math.max(scale, 1), 0);\n    };\n    Model.prototype.setDirection = function (direction) {\n        this.rotationDirection = Vector.normalize(direction);\n        this.rotationMatrix = this.calcDirectionMatrix();\n    };\n    Model.prototype.rotate = function (angle, direction) {\n        this.rotation = angle;\n        if (direction) {\n            this.rotationDirection = Vector.normalize(direction);\n        }\n        this.rotationMatrix = this.calcDirectionMatrix();\n    };\n    Model.prototype.calcDirectionMatrix = function () {\n        return calcDirectionMatrix(this.rotationDirection, this.rotation);\n    };\n    Model.prototype.getRotatedPoint = function (point) {\n        return {\n            x: point.x * this.rotationMatrix[0][0] + point.y * this.rotationMatrix[0][1] + point.z * this.rotationMatrix[0][2],\n            y: point.x * this.rotationMatrix[1][0] + point.y * this.rotationMatrix[1][1] + point.z * this.rotationMatrix[1][2],\n            z: point.x * this.rotationMatrix[2][0] + point.y * this.rotationMatrix[2][1] + point.z * this.rotationMatrix[2][2]\n        };\n    };\n    return Model;\n}(Observable));\nexport { Model };\n","export var calcDirectionMatrix = function (direction, angle) {\n    var rotationAngle = angle * (Math.PI / 180);\n    var cosAngle = Math.cos(rotationAngle);\n    var sinAngle = Math.sin(rotationAngle);\n    return [\n        [\n            cosAngle + Math.pow(direction.x, 2) * (1 - cosAngle),\n            direction.x * direction.y * (1 - cosAngle) - direction.z * sinAngle,\n            direction.x * direction.z * (1 - cosAngle) + direction.y * sinAngle\n        ],\n        [\n            direction.y * direction.x * (1 - cosAngle) + direction.z * sinAngle,\n            cosAngle + Math.pow(direction.y, 2) * (1 - cosAngle),\n            direction.y * direction.z * (1 - cosAngle) - direction.x * sinAngle\n        ],\n        [\n            direction.z * direction.x * (1 - cosAngle) - direction.y * sinAngle,\n            direction.z * direction.y * (1 - cosAngle) + direction.x * sinAngle,\n            cosAngle + Math.pow(direction.z, 2) * (1 - cosAngle)\n        ]\n    ];\n};\n","var DataProvider = /** @class */ (function () {\n    function DataProvider() {\n        this.models = [];\n    }\n    DataProvider.prototype.getModels = function () {\n        return this.models;\n    };\n    DataProvider.prototype.addModel = function (model) {\n        this.models.push(model);\n    };\n    return DataProvider;\n}());\nexport { DataProvider };\n","var __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar __generator = (this && this.__generator) || function (thisArg, body) {\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\n    function verb(n) { return function (v) { return step([n, v]); }; }\n    function step(op) {\n        if (f) throw new TypeError(\"Generator is already executing.\");\n        while (g && (g = 0, op[0] && (_ = 0)), _) try {\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\n            if (y = 0, t) op = [op[0] & 2, t.value];\n            switch (op[0]) {\n                case 0: case 1: t = op; break;\n                case 4: _.label++; return { value: op[1], done: false };\n                case 5: _.label++; y = op[1]; op = [0]; continue;\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\n                default:\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\n                    if (t[2]) _.ops.pop();\n                    _.trys.pop(); continue;\n            }\n            op = body.call(thisArg, _);\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\n    }\n};\nimport { SVGContext } from \"../context/SVGContext\";\nimport { CanvasContext } from \"../context/CanvasContext\";\nimport { Camera } from \"./Camera\";\nimport { DataProvider } from \"./DataProvider\";\nvar Scene = /** @class */ (function () {\n    function Scene(context) {\n        this.isLooping = false;\n        switch (context) {\n            case \"svg\":\n                this.context = new SVGContext();\n                break;\n            case \"canvas\":\n                this.context = new CanvasContext();\n                break;\n            default:\n                this.context = context;\n                break;\n        }\n        this.dataProvider = new DataProvider();\n        this.camera = new Camera(this.context, this.dataProvider);\n    }\n    Scene.prototype.getContext = function () {\n        return this.context;\n    };\n    Scene.prototype.getCamera = function () {\n        return this.camera;\n    };\n    Scene.prototype.requestPointerLock = function () {\n        return __awaiter(this, void 0, void 0, function () {\n            return __generator(this, function (_a) {\n                return [2 /*return*/, this.context.requestPointerLock()];\n            });\n        });\n    };\n    Scene.prototype.update = function () {\n        for (var _i = 0, _a = this.dataProvider.getModels(); _i < _a.length; _i++) {\n            var model = _a[_i];\n            //\n        }\n    };\n    Scene.prototype.add = function (model, position, id) {\n        if (id) {\n            model.setId(id);\n        }\n        if (position) {\n            model.setPosition(position);\n        }\n        this.dataProvider.addModel(model);\n    };\n    Scene.prototype.run = function (root) {\n        var _a = root.getBoundingClientRect(), width = _a.width, height = _a.height;\n        this.context.setWidth(width);\n        this.context.setHeight(height);\n        while (root.firstChild) {\n            root.removeChild(root.firstChild);\n        }\n        this.context.render(root);\n        this.camera.run();\n    };\n    Scene.prototype.stop = function () {\n        this.camera.destroy();\n    };\n    Scene.prototype.loop = function () {\n        var _this = this;\n        if (!this.isLooping) {\n            return;\n        }\n        window.requestAnimationFrame(function () {\n            _this.update();\n            _this.loop();\n        });\n    };\n    return Scene;\n}());\nexport { Scene };\n","var __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        if (typeof b !== \"function\" && b !== null)\n            throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nimport { Model } from \"../core/Model\";\nvar Sphere = /** @class */ (function (_super) {\n    __extends(Sphere, _super);\n    function Sphere(radius, position) {\n        var _this = _super.call(this, position) || this;\n        _this.radius = radius;\n        return _this;\n    }\n    return Sphere;\n}(Model));\nexport { Sphere };\n","var Dispatchable = /** @class */ (function () {\n    function Dispatchable() {\n        this.listeners = {};\n    }\n    Dispatchable.prototype.addEventListener = function (type, listener) {\n        if (!this.listeners[type]) {\n            this.listeners[type] = [];\n        }\n        this.listeners[type].push(listener);\n    };\n    Dispatchable.prototype.removeEventListener = function (type, listener) {\n        if (this.listeners[type]) {\n            var index = this.listeners[type].indexOf(listener);\n            if (index !== -1) {\n                this.listeners[type].splice(index, 1);\n            }\n        }\n    };\n    Dispatchable.prototype.dispatch = function (event) {\n        if (this.listeners[event.type]) {\n            this.listeners[event.type].forEach(function (listener) { return listener(event); });\n        }\n    };\n    return Dispatchable;\n}());\nexport { Dispatchable };\n","var __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        if (typeof b !== \"function\" && b !== null)\n            throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nimport { Model } from \"../core/Model\";\nvar Cube = /** @class */ (function (_super) {\n    __extends(Cube, _super);\n    function Cube(width, height, depth, position) {\n        var _this = _super.call(this, position) || this;\n        _this.width = width;\n        _this.height = height;\n        _this.depth = depth;\n        _this.points = [\n            { x: -width / 2, y: -height / 2, z: -depth / 2 }, // 0\n            { x: width / 2, y: -height / 2, z: -depth / 2 }, // 1\n            { x: width / 2, y: height / 2, z: -depth / 2 }, // 2\n            { x: -width / 2, y: height / 2, z: -depth / 2 }, // 3\n            { x: -width / 2, y: -height / 2, z: depth / 2 }, // 4\n            { x: width / 2, y: -height / 2, z: depth / 2 }, // 5\n            { x: width / 2, y: height / 2, z: depth / 2 }, // 6\n            { x: -width / 2, y: height / 2, z: depth / 2 } // 7\n        ];\n        _this.polygons = [\n            [0, 1, 2, 3],\n            [1, 2, 6, 5],\n            [4, 5, 6, 7],\n            [0, 4, 7, 3],\n            [7, 3, 2, 6],\n            [0, 1, 5, 4]\n        ];\n        return _this;\n    }\n    return Cube;\n}(Model));\nexport { Cube };\n","import {\n    useFormContext,\n    useController\n} from \"react-hook-form\";\n\n\ntype Props = {\n    required?: boolean;\n    name: string;\n};\n\nexport const useControl = (props: Props) => {\n    const {\n        name\n    } = props;\n\n    const {\n        formState: {\n            isSubmitting\n        }\n    } = useFormContext();\n\n    const {\n        field\n    } = useController({\n        name\n    });\n\n    return {\n        field: {\n            ...field,\n            ...isSubmitting ? {disabled: true} : {}\n        }\n    };\n};\n\nexport {Props as ControlProps};\n","import React, {useCallback} from \"react\";\nimport Grid from \"@mui/material/Grid\";\nimport Slider, {SliderProps} from \"@mui/material/Slider\";\n\nimport {useControl, ControlProps} from \"src/hooks\";\n\n\ntype Props = ControlProps & {\n    label?: SliderProps[\"title\"];\n    marks?: SliderProps[\"marks\"];\n    min?: SliderProps[\"min\"];\n    max?: SliderProps[\"max\"];\n    step?: SliderProps[\"step\"];\n};\n\nconst SliderControl: React.FC<Props> = (props) => {\n    const {\n        required,\n        label,\n        marks,\n        min,\n        max,\n        step,\n        name\n    } = props;\n\n    const {\n        field: {\n            value = 0,\n            onChange\n        }\n    } = useControl({\n        required,\n        name\n    });\n\n    const handleChange = useCallback((e: Event, value: number | number[]) => {\n        onChange(value as number);\n    }, [onChange]);\n\n    return (\n        <Grid container spacing={1} alignItems=\"center\">\n            <Grid item container width={55} justifyContent=\"flex-end\">\n                <Grid item>\n                    {value.toFixed(2)}\n                </Grid>\n            </Grid>\n\n            <Grid item xs>\n                <Slider\n                  title={label}\n                  marks={marks}\n                  min={min}\n                  max={max}\n                  step={step}\n                  value={value}\n                  onChange={handleChange} />\n            </Grid>\n        </Grid>\n    );\n};\n\n\nexport {SliderControl};\n","import React, {useCallback, ChangeEvent} from \"react\";\nimport Switch from \"@mui/material/Switch\";\n\nimport {useControl, ControlProps} from \"src/hooks\";\n\n\ntype Props = ControlProps;\n\nconst SwitchControl: React.FC<Props> = (props) => {\n    const {\n        required,\n        name\n    } = props;\n\n    const {\n        field: {\n            value = false,\n            disabled,\n            ref,\n            onChange,\n            onBlur\n        }\n    } = useControl({\n        required,\n        name\n    });\n\n    const handleChange = useCallback((e: ChangeEvent, checked: boolean) => {\n        onChange(checked);\n    }, [onChange]);\n\n    return (\n        <Switch\n          ref={ref}\n          disabled={disabled}\n          checked={value}\n          onBlur={onBlur}\n          onChange={handleChange} />\n    );\n};\n\n\nexport {SwitchControl};\n","import React from \"react\";\nimport Grid from \"@mui/material/Grid\";\n\nimport {\n    SliderControl,\n    SwitchControl\n} from \"src/controls\";\n\n\nconst ConfigForm: React.FC = () => {\n    return (\n        <Grid container spacing={1}>\n            <Grid item xs={12}>\n                <SwitchControl\n                  name=\"isRunning\" />\n            </Grid>\n\n            <Grid item xs={12}>\n                <SliderControl\n                  label=\"FOV\"\n                  min={0}\n                  max={200}\n                  name=\"fov\" />\n            </Grid>\n\n            <Grid item xs={12}>\n                <SliderControl\n                  label=\"Pitch\"\n                  min={-90}\n                  max={90}\n                  name=\"pitch\" />\n            </Grid>\n\n            <Grid item xs={12}>\n                <SliderControl\n                  label=\"Yaw\"\n                  min={-180}\n                  max={180}\n                  name=\"yaw\" />\n            </Grid>\n\n            <Grid container item xs={6} spacing={1}>\n                <Grid item xs={12}>\n                    <SliderControl\n                      label=\"Position X\"\n                      marks={[\n                        {label: \"-100\", value: -100},\n                        {label: \"0\", value: 0},\n                        {label: \"100\", value: 100}\n                      ]}\n                      min={-100}\n                      max={100}\n                      name=\"position.x\" />\n                </Grid>\n\n                <Grid item xs={12}>\n                    <SliderControl\n                      label=\"Position Y\"\n                      marks={[\n                        {label: \"-100\", value: -100},\n                        {label: \"0\", value: 0},\n                        {label: \"100\", value: 100}\n                      ]}\n                      min={-100}\n                      max={100}\n                      name=\"position.y\" />\n                </Grid>\n\n                <Grid item xs={12}>\n                    <SliderControl\n                      label=\"Position Z\"\n                      marks={[\n                        {label: \"-100\", value: -100},\n                        {label: \"0\", value: 0},\n                        {label: \"100\", value: 100}\n                      ]}\n                      min={-100}\n                      max={100}\n                      name=\"position.z\" />\n                </Grid>\n            </Grid>\n\n            <Grid container item xs={6} spacing={1}>\n                <Grid item xs={12}>\n                    <SliderControl\n                      label=\"Direction X\"\n                      marks={[\n                        {label: \"-1\", value: -1},\n                        {label: \"0\", value: 0},\n                        {label: \"1\", value: 1}\n                      ]}\n                      min={-1}\n                      max={1}\n                      step={0.01}\n                      name=\"direction.x\" />\n                </Grid>\n\n                <Grid item xs={12}>\n                    <SliderControl\n                      label=\"Direction Y\"\n                      marks={[\n                        {label: \"-1\", value: -1},\n                        {label: \"0\", value: 0},\n                        {label: \"1\", value: 1}\n                      ]}\n                      min={-1}\n                      max={1}\n                      step={0.01}\n                      name=\"direction.y\" />\n                </Grid>\n\n                <Grid item xs={12}>\n                    <SliderControl\n                      label=\"Direction Z\"\n                      marks={[\n                        {label: \"-1\", value: -1},\n                        {label: \"0\", value: 0},\n                        {label: \"1\", value: 1}\n                      ]}\n                      min={-1}\n                      max={1}\n                      step={0.01}\n                      name=\"direction.z\" />\n                </Grid>\n            </Grid>\n        </Grid>\n    );\n};\n\n\nexport {ConfigForm};\n","import React, {\n    useState,\n    useRef,\n    useCallback,\n    useEffect,\n    createContext,\n    PropsWithChildren\n} from \"react\";\nimport Drawer from \"@mui/material/Drawer\";\nimport Box from \"@mui/material/Box\";\nimport {Point, Observable} from \"motor-js\";\n\nimport {Form, FormElement} from \"src/blocks\";\nimport {ConfigForm} from \"../ConfigForm\";\n\n\ntype EventMap = {\n    changeRunning: {data: Data;};\n    changeFov: {data: Data;};\n    changePitch: {data: Data;};\n    changeYaw: {data: Data;};\n    changePosition: {data: Data;};\n    changeDirection: {data: Data;};\n};\n\ntype Data = {\n    isRunning: boolean;\n    fov: number;\n    pitch: number;\n    yaw: number;\n    position: Point;\n    direction: Point;\n};\n\ntype ContextType = {\n    isRunning: boolean;\n    setRunning: (isRunning: boolean) => void,\n    fov: number;\n    setFov: (fov: number) => void;\n    pitch: number;\n    setPitch: (pitch: number) => void;\n    yaw: number;\n    setYaw: (yaw: number) => void;\n    direction: Point;\n    setDirection: (direction: Point) => void;\n    position: Point;\n    setPosition: (position: Point) => void;\n    addEventListener: Observable<EventMap>[\"addEventListener\"];\n    removeEventListener: Observable<EventMap>[\"removeEventListener\"];\n};\n\nconst Context = createContext<ContextType>({\n    isRunning: false,\n    setRunning() {},\n    fov: 100,\n    setFov() {},\n    pitch: 0,\n    setPitch() {},\n    yaw: 0,\n    setYaw() {},\n    direction: {x: 1, y: 0, z: 0},\n    setDirection() {},\n    position: {x: 0, y: 0, z: 0},\n    setPosition() {},\n    addEventListener() {},\n    removeEventListener() {}\n});\n\ntype Props = PropsWithChildren;\n\nconst ConfigProvider: React.FC<Props> = (props) => {\n    const {children} = props;\n\n    const [isOpen, setOpen] = useState(false);\n    const [isRunning, setRunning] = useState(true);\n    const [fov, setFov] = useState(100);\n    const [pitch, setPitch] = useState(0);\n    const [yaw, setYaw] = useState(0);\n    const [position, setPosition] = useState<Point>({x: 0, y: 0, z: 0});\n    const [direction, setDirection] = useState<Point>({x: 0, y: 0, z: 1});\n    const observer = useRef<Observable<EventMap>>(new Observable<EventMap>());\n    const formRef = useRef<FormElement>(null);\n    (window as any).form = formRef;\n\n    const handleClose = useCallback(() => {\n        setOpen(false);\n    }, []);\n\n    const handleDiff = useCallback((prev: any, next: any): boolean => {\n        return JSON.stringify(prev) !== JSON.stringify(next);\n    }, []);\n\n    const handlePositionChange = useCallback((position: Point) => {\n        setPosition(position);\n    }, []);\n\n    const handleDirectionChange = useCallback((direction: Point) => {\n        setDirection(direction);\n    }, []);\n\n    const handleAddEventListener: Observable<EventMap>[\"addEventListener\"] = useCallback((type, listener) => {\n        observer.current.addEventListener(type, listener);\n    }, []);\n\n    const handleRemoveEventListener: Observable<EventMap>[\"removeEventListener\"] = useCallback((type, listener) => {\n        observer.current.removeEventListener(type, listener);\n    }, []);\n\n    const handleSubmit = useCallback((data: Data) => {\n        if(handleDiff(isRunning, data.isRunning)) {\n            setRunning(data.isRunning);\n            observer.current.emit(\"changeRunning\", {data});\n        }\n\n        if(handleDiff(position, data.position)) {\n            setPosition(data.position);\n            observer.current.emit(\"changePosition\", {data});\n        }\n\n        if(handleDiff(direction, data.direction)) {\n            setDirection(data.direction);\n            observer.current.emit(\"changeDirection\", {data});\n        }\n\n        if(handleDiff(fov, data.fov)) {\n            setFov(data.fov);\n            observer.current.emit(\"changeFov\", {data});\n        }\n\n        if(handleDiff(pitch, data.pitch)) {\n            setPitch(data.pitch);\n            observer.current.emit(\"changePitch\", {data});\n        }\n\n        if(handleDiff(yaw, data.yaw)) {\n            setYaw(data.yaw);\n            observer.current.emit(\"changeYaw\", {data});\n        }\n    }, [position, direction, fov, pitch, yaw, pitch]);\n\n    useEffect(() => {\n        const handleKeydown = (e: KeyboardEvent) => {\n            if(e.key === \"p\") {\n                setOpen((open) => !open);\n                e.preventDefault();\n            }\n        };\n\n        document.addEventListener(\"keydown\", handleKeydown);\n\n        return () => {\n            document.removeEventListener(\"keydown\", handleKeydown);\n        };\n    }, []);\n\n    return (\n        <Context.Provider\n          value={{\n            isRunning,\n            setRunning,\n            fov,\n            setFov,\n            pitch,\n            setPitch,\n            yaw,\n            setYaw,\n            direction,\n            setDirection: handleDirectionChange,\n            position,\n            setPosition: handlePositionChange,\n            addEventListener: handleAddEventListener,\n            removeEventListener: handleRemoveEventListener\n          }}>\n            <Drawer\n              sx={{\n                width: \"50vw\"\n              }}\n              PaperProps={{\n                sx: {\n                    width: \"50vw\",\n                    padding: 2\n                }\n              }}\n              open={isOpen}\n              anchor=\"right\"\n              onClose={handleClose}>\n                <Form\n                  ref={formRef}\n                  mode=\"onSubmit\"\n                  values={{\n                    isRunning,\n                    fov,\n                    pitch,\n                    yaw,\n                    position,\n                    direction\n                  }}\n                  shouldUnregister\n                  onChange={handleSubmit}>\n                    <Box sx={{paddingLeft: 2, paddingRight: 2}}>\n                        <ConfigForm />\n                    </Box>\n                </Form>\n            </Drawer>\n\n            {children}\n        </Context.Provider>\n    );\n};\n\n\nexport {\n    ConfigProvider,\n    Context as ConfigContext\n};\n","import {Model, Polygon, Point, BSPNode} from \"motor-js\";\n\n\nexport class Lines extends Model {\n    constructor() {\n        super();\n\n        this.points = [];\n        this.polygons = [];\n    }\n\n    public addPolygon(p: Polygon) {\n        const indexes: number[] = [];\n\n        for(let i = 0; i < p.points.length; i++) {\n            indexes.push(this.points.length);\n            this.points.push(p.points[i]);\n        }\n\n        this.polygons.push(indexes);\n    }\n\n    public addLine(start: Point, end: Point) {\n        const index = this.points.length;\n\n        this.points.push(start);\n        this.points.push(end);\n\n        this.polygons.push([index, index + 1]);\n    }\n\n    public getPolygons(): number[][] {\n        return this.polygons;\n    }\n}\n","import React, {\n    useState,\n    useRef,\n    useContext,\n    useCallback,\n    useEffect,\n    MouseEvent as RMouseEvent\n} from \"react\";\nimport {\n    Scene,\n    Cube,\n    Polygon,\n    Vector,\n    BSPNode,\n    CameraPositionChangeEvent,\n    CameraDirectionChangeEvent,\n    CameraFovChangeEvent\n} from \"motor-js\";\n\nimport {ConfigContext} from \"../ConfigProvider\";\nimport {Lines} from \"../../models/Lines\";\n\n\nconst PathBuilder: React.FC = () => {\n    const [isLocked, setLocked] = useState(false);\n    const rootRef = useRef(null);\n    const sceneRef = useRef<Scene>();\n    const config = useContext(ConfigContext);\n\n    const handleContextMenu = useCallback((e: RMouseEvent) => {\n        if(!sceneRef.current) {\n            return;\n        }\n\n        const scene = sceneRef.current;\n        scene.getCamera().activateDebug();\n\n        e.preventDefault();\n        e.stopPropagation();\n    }, []);\n\n    const handleClick = useCallback(() => {\n        if(!sceneRef.current) {\n            return;\n        }\n\n        sceneRef.current.requestPointerLock();\n    }, []);\n\n    useEffect(() => {\n        if(!rootRef.current) {\n            return;\n        }\n\n        const scene = sceneRef.current = new Scene(\"canvas\");\n\n        const lines = new Lines();\n\n        const a = new Polygon([\n            {x: -100, y: -10, z: -10},\n            {x: 0, y: 90, z: -10},\n            {x: 100, y: -10, z: -10}\n        ]);\n        a.setId(\"a\");\n\n        const b = new Polygon([\n            {x: -10, y: 0, z: -90},\n            {x: -10, y: 120, z: 0},\n            {x: -10, y: 0, z: 90}\n        ]);\n        b.setId(\"b\");\n\n        const c = new Polygon([\n            {x: -30, y: 0, z: -20},\n            {x: -20, y: 50, z: 0},\n            {x: -10, y: 0, z: -10}\n        ]);\n        c.setId(\"c\");\n\n        lines.addPolygon(b);\n        lines.addPolygon(a);\n        lines.addPolygon(c);\n        lines.addPolygon(new Polygon([\n            {x: 100, y: -30, z: 100},\n            {x: 100, y: -30, z: -100},\n            {x: -100, y: -30, z: -100},\n            {x: -100, y: -30, z: 100}\n        ]));\n\n        // scene.add(new Cube(100, 100, 100), {x: 0, y: 0, z: 0}, \"cube\");\n        // scene.add(new Cube(200, 1, 200), {x: 0, y: -100, z: 0}, \"ground\");\n        lines.setId(\"lines\");\n\n        scene.add(lines);\n\n        scene.add(new Cube(100, 100, 100), {x: 0, y: 0, z: 0}, \"cube\");\n        // scene.add(new Cube(200, 1, 200), {x: 0, y: -55, z: 0}, \"ground\");\n        scene.add(new Cube(1, 400, 400), {x: -120, y: 0, z: 0}, \"fance\");\n\n        // for(let i = -7; i <= 7; i++) {\n        //     for(let j = -7; j <= 7; j++) {\n        //         scene.add(new Cube(200, 1, 200), {x: 200 * i, y: -2000, z: 200 * j});\n        //         scene.add(new Cube(200, 1, 200), {x: 200 * i, y: 2000, z: 200 * j});\n        //     }\n        // }\n\n        const camera = scene.getCamera();\n\n        camera.setPitch(config.pitch);\n        camera.setYaw(config.yaw);\n        camera.setPosition(config.position);\n        camera.setFov(config.fov)\n\n        scene.run(rootRef.current);\n\n        return () => {\n            scene.stop();\n        };\n    }, []);\n\n    useEffect(() => {\n        const handleLockChange = () => {\n            const locked = !!document.pointerLockElement;\n\n            setLocked(locked);\n        };\n\n        document.addEventListener(\"pointerlockchange\", handleLockChange);\n\n        return () => {\n            document.removeEventListener(\"pointerlockchange\", handleLockChange);\n        };\n    }, []);\n\n    useEffect(() => {\n        let forwardInterval: NodeJS.Timeout;\n        let backInterval: NodeJS.Timeout;\n        let leftInterval: NodeJS.Timeout;\n        let rightInterval: NodeJS.Timeout;\n        let upInterval: NodeJS.Timeout;\n        let downInterval: NodeJS.Timeout;\n\n        const handleDown = (e: KeyboardEvent) => {\n            if(!sceneRef.current) {\n                return;\n            }\n\n            const scene = sceneRef.current;\n            const camera = scene.getCamera();\n            let position = camera.getPosition();\n\n            switch(e.key) {\n                case \"ArrowUp\":\n                    camera.setPosition({\n                        ...position,\n                        z: position.z + 1\n                    });\n                    break;\n\n                case \"ArrowDown\":\n                    camera.setPosition({\n                        ...position,\n                        z: position.z - 1\n                    });\n                    break;\n\n                case \"ArrowLeft\":\n                    camera.setPosition({\n                        ...position,\n                        x: position.x + 1\n                    });\n                    break;\n\n                case \"ArrowRight\":\n                    camera.setPosition({\n                        ...position,\n                        x: position.x - 1\n                    });\n                    break;\n\n                case \"w\": {\n                    clearInterval(forwardInterval);\n                    forwardInterval = setInterval(() => {\n                        const camera = scene.getCamera();\n\n                        camera.setPosition({\n                            x: camera.getPosition().x + camera.getDirection().x,\n                            y: camera.getPosition().y + camera.getDirection().y,\n                            z: camera.getPosition().z + camera.getDirection().z\n                        });\n                    }, 0);\n\n                    e.preventDefault();\n                    e.stopPropagation();\n                    break;\n                }\n\n                case \"a\": {\n                    clearInterval(leftInterval);\n                    leftInterval = setInterval(() => {\n                        const camera = scene.getCamera();\n\n                        camera.setPosition({\n                            x: camera.getPosition().x + camera.getDirectionLeft().x,\n                            y: camera.getPosition().y + camera.getDirectionLeft().y,\n                            z: camera.getPosition().z + camera.getDirectionLeft().z\n                        });\n                    }, 0);\n                    e.preventDefault();\n                    e.stopPropagation();\n                    break;\n                }\n\n                case \"d\": {\n                    clearInterval(rightInterval);\n                    rightInterval = setInterval(() => {\n                        const camera = scene.getCamera();\n                        camera.setPosition({\n                            x: camera.getPosition().x - camera.getDirectionLeft().x,\n                            y: camera.getPosition().y - camera.getDirectionLeft().y,\n                            z: camera.getPosition().z - camera.getDirectionLeft().z\n                        });\n                    }, 0);\n                    e.preventDefault();\n                    e.stopPropagation();\n                    break;\n                }\n\n                case \"s\": {\n                    clearInterval(backInterval);\n                    backInterval = setInterval(() => {\n                        const camera = scene.getCamera();\n\n                        camera.setPosition({\n                            x: camera.getPosition().x - camera.getDirection().x,\n                            y: camera.getPosition().y - camera.getDirection().y,\n                            z: camera.getPosition().z - camera.getDirection().z\n                        });\n                    }, 0);\n\n                    e.preventDefault();\n                    e.stopPropagation();\n                    break;\n                }\n\n                case \"q\": {\n                    clearInterval(downInterval);\n                    downInterval = setInterval(() => {\n                        const camera = scene.getCamera();\n                        const position = camera.getPosition();\n\n                        camera.setPosition({\n                            ...position,\n                            y: position.y - 1\n                        });\n                    }, 0);\n\n                    e.preventDefault();\n                    e.stopPropagation();\n                    break;\n                }\n\n                case \"e\": {\n                    clearInterval(upInterval);\n                    upInterval = setInterval(() => {\n                        const camera = scene.getCamera();\n                        const position = camera.getPosition();\n\n                        camera.setPosition({\n                            ...position,\n                            y: position.y + 1\n                        });\n                    }, 0);\n                    e.preventDefault();\n                    e.stopPropagation();\n                    break;\n                }\n            }\n        };\n\n        const handleUp = (e: KeyboardEvent) => {\n            switch(e.key) {\n                case \"w\":\n                    clearInterval(forwardInterval);\n                    break;\n\n                case \"a\":\n                    clearInterval(leftInterval);\n                    break;\n\n                case \"d\":\n                    clearInterval(rightInterval);\n                    break;\n\n                case \"s\":\n                    clearInterval(backInterval);\n                    break;\n\n                case \"q\":\n                    clearInterval(downInterval);\n                    break;\n\n                case \"e\":\n                    clearInterval(upInterval);\n                    break;\n            }\n        };\n\n        document.addEventListener(\"keypress\", handleDown);\n        document.addEventListener(\"keyup\", handleUp);\n\n        return () => {\n            document.removeEventListener(\"keypress\", handleDown);\n            document.removeEventListener(\"keyup\", handleUp);\n        };\n    }, []);\n\n    useEffect(() => {\n        if(!isLocked) {\n            return;\n        }\n\n        const handleMove = (e: MouseEvent) => {\n            if(!sceneRef.current) {\n                return;\n            }\n\n            const camera = sceneRef.current.getCamera();\n\n            camera.setDirectionFromAngles(\n                camera.getPitch() - e.movementY * 0.1,\n                camera.getYaw() + e.movementX * 0.1\n            );\n        };\n\n        document.addEventListener(\"mousemove\", handleMove);\n\n        return () => {\n            document.removeEventListener(\"mousemove\", handleMove);\n        };\n    }, [isLocked]);\n\n    useEffect(() => {\n        if(!sceneRef.current) {\n            return;\n        }\n\n        const camera = sceneRef.current.getCamera();\n\n        const handlePositionChange = (e: CameraPositionChangeEvent) => {\n            const {position} = e;\n\n            config.setPosition(position);\n        };\n\n        const handleChangeDirection = (e: CameraDirectionChangeEvent) => {\n            const {\n                direction,\n                yaw,\n                pitch\n            } = e;\n\n            config.setDirection(direction);\n            config.setPitch(pitch);\n            config.setYaw(yaw);\n        };\n\n        const handleFovChange = (e: CameraFovChangeEvent) => {\n            const {\n                fov\n            } = e;\n\n            config.setFov(fov);\n        };\n\n        // const handlePitchChange = () => {};\n\n        camera.addEventListener(\"positionChange\", handlePositionChange);\n        camera.addEventListener(\"directionChange\", handleChangeDirection);\n        camera.addEventListener(\"fovChange\", handleFovChange);\n        // camera.addEventListener(\"\");\n\n        return () => {\n            camera.removeEventListener(\"positionChange\", handlePositionChange);\n            camera.removeEventListener(\"directionChange\", handleChangeDirection);\n            camera.removeEventListener(\"fovChange\", handleFovChange);\n        };\n    }, [config]);\n\n    useEffect(() => {\n        const handleRunningChange = (e) => {\n            if(!rootRef.current || !sceneRef.current) {\n                return;\n            }\n\n            const scene = sceneRef.current;\n\n            if(!e.data.isRunning) {\n                scene.stop();\n            }\n            else {\n                scene.run(rootRef.current);\n            }\n        };\n\n        const handleChangePosition = (e) => {\n            if(!sceneRef.current) {\n                return;\n            }\n\n            const camera = sceneRef.current.getCamera();\n\n            const {\n                data: {\n                    position\n                }\n            } = e;\n\n            camera.setPosition(position);\n        };\n\n        const handleDirectionChange = (e) => {\n            if(!sceneRef.current) {\n                return;\n            }\n\n            const camera = sceneRef.current.getCamera();\n\n            const {\n                data: {\n                    direction\n                }\n            } = e;\n\n            camera.setDirection(direction);\n        };\n\n        const handleFovChange = (e) => {\n            if(!sceneRef.current) {\n                return;\n            }\n\n            const camera = sceneRef.current.getCamera();\n\n            const {\n                data: {\n                    fov\n                }\n            } = e;\n\n            camera.setFov(fov);\n        };\n\n        const handlePitchChange = (e) => {\n            if(!sceneRef.current) {\n                return;\n            }\n\n            const camera = sceneRef.current.getCamera();\n\n            const {\n                data: {\n                    pitch\n                }\n            } = e;\n\n            camera.setPitch(pitch);\n        };\n\n        const handleYawChange = (e) => {\n            if(!sceneRef.current) {\n                return;\n            }\n\n            const camera = sceneRef.current.getCamera();\n\n            const {\n                data: {\n                    yaw\n                }\n            } = e;\n\n            camera.setYaw(yaw);\n        };\n\n        config.addEventListener(\"changeRunning\", handleRunningChange);\n        config.addEventListener(\"changePosition\", handleChangePosition);\n        config.addEventListener(\"changeDirection\", handleDirectionChange);\n        config.addEventListener(\"changeFov\", handleFovChange);\n        config.addEventListener(\"changeYaw\", handleYawChange);\n        config.addEventListener(\"changePitch\", handlePitchChange);\n\n        return () => {\n            config.removeEventListener(\"changeRunning\", handleRunningChange);\n            config.removeEventListener(\"changePosition\", handleChangePosition);\n            config.removeEventListener(\"changeDirection\", handleDirectionChange);\n            config.removeEventListener(\"changeFov\", handleFovChange);\n            config.removeEventListener(\"changeYaw\", handleYawChange);\n            config.removeEventListener(\"changePitch\", handlePitchChange);\n        };\n    }, [config]);\n\n    return (\n        <div\n          ref={rootRef}\n          style={{\n            width: \"100%\",\n            height: \"calc(100vh - 55px)\"\n          }}\n          onClick={handleClick}\n          onContextMenu={handleContextMenu} />\n    );\n};\n\n\nexport {PathBuilder};\n","import React from \"react\";\n\nimport {\n    ConfigProvider,\n    PathBuilder\n} from \"./blocks\";\n\n\nconst PathBuilderPage: React.FC = () => {\n    return (\n        <ConfigProvider>\n            <PathBuilder />\n        </ConfigProvider>\n    );\n};\n\n\nexport default PathBuilderPage;\n"],"names":["Context","this","width","height","prototype","getWidth","getHeight","setWidth","setHeight","__extends","extendStatics","d","b","Object","setPrototypeOf","__proto__","Array","p","hasOwnProperty","call","TypeError","String","__","constructor","create","CanvasContext","_super","_this","canvas","document","createElement","context","getContext","setStrokeStyle","color","strokeStyle","setFillStyle","fillStyle","drawLine","start","end","lineWidth","beginPath","moveTo","x","y","lineTo","stroke","closePath","fillRect","w","h","fillPolygon","points","rest","slice","i","length","fill","clear","clearRect","requestPointerLock","render","root","_a","getBoundingClientRect","append","SVGContext","svg","createElementNS","setAttribute","createSVGElement","type","line","concat","appendChild","rect","polygon","map","point","join","firstChild","removeChild","Vector","z","defineProperty","get","distance","enumerable","configurable","set","add","summary","multiply","by","sub","subtract","normalize","toPoint","fromPoint","a","cross","Math","sqrt","pow","magnitude","dot","angle","v1","v2","mag1","mag2","acos","intersectPlaneV1","rayOrigin","rayVector","v0","edge1","edge2","planeNormal","denominator","abs","t","intersectPlaneV2","direction","normal","denom","intersectPolygon","getNormal","isNaN","isFinite","intersectPoint","console","log","p1","p2","side1","side2","crossProduct","areCoDirected","pt1","pt2","ratioX","ratioY","ratioZ","epsilon","__spreadArray","to","from","pack","arguments","ar","l","Polygon","calcNormal","setId","id","intersects","_i","axes_1","getNormals","axis","projection1","projection","projection2","max","min","smooth","p3","vector1","vector2","getCenter","center","isOnSamePlane","isContainPointV1","inside","dot00","dot01","dot02","dot11","dot12","invDenom","u","v","isContainPointV2","sum","a1","a2","vector","PI","isContainPointV3","isIntersect","A","B","intersect","debug","before","after","isBefore","push","j","b1","b2","b3","ABefore","AAfter","normals","edge","BSPNode","polygons","front","back","polygons_1","_b","intersects_1","classifyPolygon","classifyPolygonV4","classifyPolygonV1","classifyPolygonV2","classifyPolygonV3","isInFrontV3","isInFront","position","viewVector","isInFrontV2","traverse","traverseV4","traverseV1","traverseV2","traverseV3","Observable","listeners","addEventListener","listener","removeEventListener","index","indexOf","splice","emit","event","forEach","Camera","dataProvider","isRunning","fov","pitch","yaw","roll","rotationMatrix","calcDirectionMatrix","getPosition","setPosition","up","right","newUp","calcCameraRotationMatrixV2","rotatePoint","transformPointToCameraView","getModels","matrix","projectPoint","NaN","scale","getFov","setFov","getDirection","getDirectionLeft","setDirection","setDirectionFromAngles","pitchRadians","yawRadians","cos","sin","getYaw","getPitch","setPitch","setYaw","getRoll","setRoll","update","reduce","model","modelIndex","getPoints","getPolygons","indexes","polygonIndex","polygonPoints","getId","filter","run","loop","destroy","activateDebug","requestAnimationFrame","Model","rotation","rotationDirection","getRotatedPoint","getPolygons2","getScale","setScale","rotate","rotationAngle","cosAngle","sinAngle","DataProvider","models","addModel","__awaiter","thisArg","_arguments","P","generator","Promise","resolve","reject","fulfilled","value","step","next","e","rejected","result","done","then","apply","__generator","body","f","g","_","label","sent","trys","ops","verb","Symbol","iterator","n","op","pop","Scene","isLooping","camera","getCamera","stop","window","Dispatchable","dispatch","Sphere","radius","Cube","depth","useControl","props","name","formState","isSubmitting","useFormContext","field","useController","disabled","SliderControl","required","marks","onChange","handleChange","useCallback","_jsxs","Grid","container","spacing","alignItems","children","_jsx","item","justifyContent","toFixed","xs","Slider","title","SwitchControl","ref","onBlur","checked","Switch","ConfigForm","createContext","setRunning","ConfigProvider","isOpen","setOpen","useState","observer","useRef","formRef","form","handleClose","handleDiff","prev","JSON","stringify","handlePositionChange","handleDirectionChange","handleAddEventListener","current","handleRemoveEventListener","handleSubmit","data","useEffect","handleKeydown","key","open","preventDefault","Provider","Drawer","sx","PaperProps","padding","anchor","onClose","Form","mode","values","shouldUnregister","Box","paddingLeft","paddingRight","Lines","super","addPolygon","addLine","PathBuilder","isLocked","setLocked","rootRef","sceneRef","config","useContext","ConfigContext","handleContextMenu","stopPropagation","handleClick","scene","lines","c","handleLockChange","locked","pointerLockElement","forwardInterval","backInterval","leftInterval","rightInterval","upInterval","downInterval","handleDown","clearInterval","setInterval","handleUp","handleMove","movementY","movementX","handleChangeDirection","handleFovChange","handleRunningChange","handleChangePosition","handlePitchChange","handleYawChange","style","onClick","onContextMenu","PathBuilderPage"],"sourceRoot":""}